import{S as zr,i as Gr,s as qr}from"../chunks/index.eceac6f7.js";import{c as Qe,g as Yr,a as Hr}from"../chunks/_commonjsHelpers.87174ba5.js";var ie={exports:{}},Ot={},St={};const Vr={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},Kr={arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},Wr={arity:1,flags:["fast"],keyStart:0,keyStop:0,step:0},Jr={arity:-2,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},Xr={arity:1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},Zr={arity:-1,flags:["admin","noscript","no_async_loading"],keyStart:0,keyStop:0,step:0},$r={arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},tn={arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},en={arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},rn={arity:-4,flags:["write","denyoom"],keyStart:2,keyStop:-1,step:1},nn={arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},sn={arity:6,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},on={arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},an={arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},cn={arity:-3,flags:["write","noscript","blocking"],keyStart:1,keyStop:-2,step:1},ln={arity:4,flags:["write","denyoom","noscript","blocking"],keyStart:1,keyStop:2,step:1},un={arity:-5,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},fn={arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},hn={arity:-3,flags:["write","noscript","blocking","fast"],keyStart:1,keyStop:-2,step:1},pn={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},dn={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},yn={arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},gn={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},mn={arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},bn={arity:1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},Sn={arity:-2,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},kn={arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},wn={arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},vn={arity:-2,flags:["write"],keyStart:1,keyStop:-1,step:1},xn={arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},En={arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},Cn={arity:2,flags:["fast"],keyStart:0,keyStop:0,step:0},_n={arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},An={arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},Bn={arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},Tn={arity:1,flags:["noscript","loading","stale","skip_slowlog"],keyStart:0,keyStop:0,step:0},Mn={arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},Rn={arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},On={arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Fn={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},In={arity:-1,flags:["admin","noscript","stale"],keyStart:0,keyStop:0,step:0},Dn={arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},Pn={arity:-3,flags:["readonly","noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},Nn={arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},jn={arity:-1,flags:["write"],keyStart:0,keyStop:0,step:0},Un={arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},Qn={arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},Ln={arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},zn={arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},Gn={arity:-6,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},qn={arity:-6,flags:["readonly"],keyStart:1,keyStop:1,step:1},Yn={arity:-5,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},Hn={arity:-5,flags:["readonly"],keyStart:1,keyStop:1,step:1},Vn={arity:-7,flags:["readonly"],keyStart:1,keyStop:1,step:1},Kn={arity:-8,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},Wn={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},Jn={arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},Xn={arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Zn={arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},$n={arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},ts={arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},es={arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},rs={arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},ns={arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},ss={arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},is={arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},os={arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},as={arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},cs={arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},ls={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},us={arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},fs={arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},hs={arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},ps={arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},ds={arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},ys={arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},gs={arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},ms={arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},bs={arity:2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},Ss={arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},ks={arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},ws={arity:-1,flags:["loading","stale"],keyStart:0,keyStop:0,step:0},vs={arity:2,flags:["readonly"],keyStart:0,keyStop:0,step:0},xs={arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},Es={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},Cs={arity:-3,flags:["readonly"],keyStart:1,keyStop:2,step:1},_s={arity:3,flags:["readonly"],keyStart:1,keyStop:1,step:1},As={arity:5,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},Bs={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},Ts={arity:5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},Ms={arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},Rs={arity:-1,flags:["readonly","fast"],keyStart:0,keyStop:0,step:0},Os={arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Fs={arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},Is={arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},Ds={arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},Ps={arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},Ns={arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},js={arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},Us={arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},Qs={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},Ls={arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},zs={arity:-6,flags:["write","movablekeys"],keyStart:3,keyStop:3,step:1},Gs={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},qs={arity:1,flags:["admin","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},Ys={arity:3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Hs={arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},Vs={arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:2},Ks={arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},Ws={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},Js={arity:2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Xs={arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Zs={arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},$s={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},ti={arity:-2,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},ei={arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},ri={arity:3,flags:["write","denyoom","admin"],keyStart:2,keyStop:2,step:1},ni={arity:-2,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},si={arity:1,flags:["admin"],keyStart:0,keyStop:0,step:0},ii={arity:-1,flags:["fast"],keyStart:0,keyStop:0,step:0},oi={arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},ai={arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},ci={arity:-3,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},li={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},ui={arity:3,flags:["pubsub","loading","stale","fast"],keyStart:0,keyStop:0,step:0},fi={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},hi={arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},pi={arity:-1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},di={arity:1,flags:["readonly"],keyStart:0,keyStop:0,step:0},yi={arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},gi={arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},mi={arity:3,flags:["write"],keyStart:1,keyStop:2,step:1},bi={arity:3,flags:["write","fast"],keyStart:1,keyStop:2,step:1},Si={arity:-1,flags:["admin","noscript","loading","stale","allow_busy"],keyStart:0,keyStop:0,step:0},ki={arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},wi={arity:1,flags:["noscript","loading","stale","fast","no_auth","allow_busy"],keyStart:0,keyStop:0,step:0},vi={arity:-4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},xi={arity:1,flags:["noscript","loading","stale","fast"],keyStart:0,keyStop:0,step:0},Ei={arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Ci={arity:3,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},_i={arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},Ai={arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},Bi={arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},Ti={arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},Mi={arity:-2,flags:["readonly"],keyStart:0,keyStop:0,step:0},Ri={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},Oi={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},Fi={arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},Ii={arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},Di={arity:2,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},Pi={arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},Ni={arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},ji={arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},Ui={arity:3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},Qi={arity:4,flags:["write","denyoom"],keyStart:1,keyStop:1,step:1},Li={arity:-1,flags:["admin","noscript","loading","stale","no_multi","allow_busy"],keyStart:0,keyStop:0,step:0},zi={arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},Gi={arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},qi={arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},Yi={arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},Hi={arity:3,flags:["admin","noscript","stale","no_async_loading"],keyStart:0,keyStop:0,step:0},Vi={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},Ki={arity:2,flags:["readonly"],keyStart:1,keyStop:1,step:1},Wi={arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},Ji={arity:4,flags:["write","fast"],keyStart:1,keyStop:2,step:1},Xi={arity:-2,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},Zi={arity:-2,flags:["readonly","movablekeys"],keyStart:1,keyStop:1,step:1},$i={arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},to={arity:3,flags:["pubsub","loading","stale","fast"],keyStart:1,keyStop:1,step:1},eo={arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},ro={arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},no={arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},so={arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},io={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},oo={arity:-2,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},ao={arity:4,flags:["readonly"],keyStart:1,keyStop:1,step:1},co={arity:-2,flags:["readonly"],keyStart:1,keyStop:-1,step:1},lo={arity:-3,flags:["write","denyoom"],keyStart:1,keyStop:-1,step:1},uo={arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:1,keyStop:-1,step:1},fo={arity:3,flags:["write","fast"],keyStart:0,keyStop:0,step:0},ho={arity:1,flags:["admin","noscript","no_async_loading","no_multi"],keyStart:0,keyStop:0,step:0},po={arity:1,flags:["loading","stale","fast"],keyStart:0,keyStop:0,step:0},yo={arity:-2,flags:["readonly","fast"],keyStart:1,keyStop:-1,step:1},go={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},mo={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},bo={arity:-2,flags:["write","fast"],keyStart:1,keyStop:-1,step:1},So={arity:-1,flags:["pubsub","noscript","loading","stale"],keyStart:0,keyStop:0,step:0},ko={arity:1,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:0,keyStop:0,step:0},wo={arity:3,flags:["noscript"],keyStart:0,keyStop:0,step:0},vo={arity:-2,flags:["noscript","loading","stale","fast","allow_busy"],keyStart:1,keyStop:-1,step:1},xo={arity:-4,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Eo={arity:-5,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},Co={arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},_o={arity:-6,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Ao={arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Bo={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},To={arity:-2,flags:[],keyStart:0,keyStop:0,step:0},Mo={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},Ro={arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},Oo={arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},Fo={arity:-4,flags:["readonly","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},Io={arity:-7,flags:["write","blocking","movablekeys"],keyStart:0,keyStop:0,step:0},Do={arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},Po={arity:-3,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},No={arity:-4,flags:["write"],keyStart:1,keyStop:1,step:1},jo={arity:-4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},Uo={arity:2,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},Qo={arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},Lo={arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},zo={arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},Go={arity:4,flags:["write","denyoom","fast"],keyStart:1,keyStop:1,step:1},qo={arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},Yo={arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},Ho={arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},Vo={arity:4,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},Ko={arity:-4,flags:["write","movablekeys"],keyStart:0,keyStop:0,step:0},Wo={arity:-3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},Jo={arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Xo={arity:-2,flags:["write","fast"],keyStart:1,keyStop:1,step:1},Zo={arity:-2,flags:["readonly"],keyStart:1,keyStop:1,step:1},$o={arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},ta={arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},ea={arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},ra={arity:-5,flags:["write","denyoom"],keyStart:1,keyStop:2,step:1},na={arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},sa={arity:-3,flags:["write","fast"],keyStart:1,keyStop:1,step:1},ia={arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},oa={arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},aa={arity:4,flags:["write"],keyStart:1,keyStop:1,step:1},ca={arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},la={arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},ua={arity:-4,flags:["readonly"],keyStart:1,keyStop:1,step:1},fa={arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},ha={arity:-3,flags:["readonly"],keyStart:1,keyStop:1,step:1},pa={arity:3,flags:["readonly","fast"],keyStart:1,keyStop:1,step:1},da={arity:-3,flags:["readonly","movablekeys"],keyStart:0,keyStop:0,step:0},ya={arity:-4,flags:["write","denyoom","movablekeys"],keyStart:1,keyStop:1,step:1},ga={acl:Vr,append:Kr,asking:Wr,auth:Jr,bgrewriteaof:Xr,bgsave:Zr,bitcount:$r,bitfield:tn,bitfield_ro:en,bitop:rn,bitpos:nn,blmove:sn,blmpop:on,blpop:an,brpop:cn,brpoplpush:ln,bzmpop:un,bzpopmax:fn,bzpopmin:hn,client:pn,cluster:dn,command:yn,config:gn,copy:mn,dbsize:bn,debug:Sn,decr:kn,decrby:wn,del:vn,discard:xn,dump:En,echo:Cn,eval:{arity:-3,flags:["noscript","stale","skip_monitor","no_mandatory_keys","movablekeys"],keyStart:0,keyStop:0,step:0},eval_ro:_n,evalsha:An,evalsha_ro:Bn,exec:Tn,exists:Mn,expire:Rn,expireat:On,expiretime:Fn,failover:In,fcall:Dn,fcall_ro:Pn,flushall:Nn,flushdb:jn,function:{arity:-2,flags:[],keyStart:0,keyStop:0,step:0},geoadd:Un,geodist:Qn,geohash:Ln,geopos:zn,georadius:Gn,georadius_ro:qn,georadiusbymember:Yn,georadiusbymember_ro:Hn,geosearch:Vn,geosearchstore:Kn,get:Wn,getbit:Jn,getdel:Xn,getex:Zn,getrange:$n,getset:ts,hdel:es,hello:rs,hexists:ns,hget:ss,hgetall:is,hincrby:os,hincrbyfloat:as,hkeys:cs,hlen:ls,hmget:us,hmset:fs,hrandfield:hs,hscan:ps,hset:ds,hsetnx:ys,hstrlen:gs,hvals:ms,incr:bs,incrby:Ss,incrbyfloat:ks,info:ws,keys:vs,lastsave:xs,latency:Es,lcs:Cs,lindex:_s,linsert:As,llen:Bs,lmove:Ts,lmpop:Ms,lolwut:Rs,lpop:Os,lpos:Fs,lpush:Is,lpushx:Ds,lrange:Ps,lrem:Ns,lset:js,ltrim:Us,memory:Qs,mget:Ls,migrate:zs,module:Gs,monitor:qs,move:Ys,mset:Hs,msetnx:Vs,multi:Ks,object:Ws,persist:Js,pexpire:Xs,pexpireat:Zs,pexpiretime:$s,pfadd:ti,pfcount:ei,pfdebug:ri,pfmerge:ni,pfselftest:si,ping:ii,psetex:oi,psubscribe:ai,psync:ci,pttl:li,publish:ui,pubsub:fi,punsubscribe:hi,quit:pi,randomkey:di,readonly:yi,readwrite:gi,rename:mi,renamenx:bi,replconf:Si,replicaof:ki,reset:wi,restore:vi,"restore-asking":{arity:-4,flags:["write","denyoom","asking"],keyStart:1,keyStop:1,step:1},role:xi,rpop:Ei,rpoplpush:Ci,rpush:_i,rpushx:Ai,sadd:Bi,save:Ti,scan:Mi,scard:Ri,script:Oi,sdiff:Fi,sdiffstore:Ii,select:Di,set:Pi,setbit:Ni,setex:ji,setnx:Ui,setrange:Qi,shutdown:Li,sinter:zi,sintercard:Gi,sinterstore:qi,sismember:Yi,slaveof:Hi,slowlog:Vi,smembers:Ki,smismember:Wi,smove:Ji,sort:Xi,sort_ro:Zi,spop:$i,spublish:to,srandmember:eo,srem:ro,sscan:no,ssubscribe:so,strlen:io,subscribe:oo,substr:ao,sunion:co,sunionstore:lo,sunsubscribe:uo,swapdb:fo,sync:ho,time:po,touch:yo,ttl:go,type:mo,unlink:bo,unsubscribe:So,unwatch:ko,wait:wo,watch:vo,xack:xo,xadd:Eo,xautoclaim:Co,xclaim:_o,xdel:Ao,xgroup:Bo,xinfo:To,xlen:Mo,xpending:Ro,xrange:Oo,xread:Fo,xreadgroup:Io,xrevrange:Do,xsetid:Po,xtrim:No,zadd:jo,zcard:Uo,zcount:Qo,zdiff:Lo,zdiffstore:zo,zincrby:Go,zinter:qo,zintercard:Yo,zinterstore:Ho,zlexcount:Vo,zmpop:Ko,zmscore:Wo,zpopmax:Jo,zpopmin:Xo,zrandmember:Zo,zrange:$o,zrangebylex:ta,zrangebyscore:ea,zrangestore:ra,zrank:na,zrem:sa,zremrangebylex:ia,zremrangebyrank:oa,zremrangebyscore:aa,zrevrange:ca,zrevrangebylex:la,zrevrangebyscore:ua,zrevrank:fa,zscan:ha,zscore:pa,zunion:da,zunionstore:ya};(function(e){var t=Qe&&Qe.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(e,"__esModule",{value:!0}),e.getKeyIndexes=e.hasFlag=e.exists=e.list=void 0;const r=t(ga);e.list=Object.keys(r.default);const i={};e.list.forEach(h=>{i[h]=r.default[h].flags.reduce(function(m,g){return m[g]=!0,m},{})});function o(h){return!!r.default[h]}e.exists=o;function l(h,m){if(!i[h])throw new Error("Unknown command "+h);return!!i[h][m]}e.hasFlag=l;function u(h,m,g){const w=r.default[h];if(!w)throw new Error("Unknown command "+h);if(!Array.isArray(m))throw new Error("Expect args to be an array");const E=[],A=!!(g&&g.parseExternalKey),p=(x,v)=>{const M=[],d=Number(x[v]);for(let b=0;b<d;b++)M.push(b+v+1);return M},R=(x,v,M)=>{for(let d=v;d<x.length-1;d+=1)if(String(x[d]).toLowerCase()===M.toLowerCase())return d+1;return null};switch(h){case"zunionstore":case"zinterstore":case"zdiffstore":E.push(0,...p(m,1));break;case"eval":case"evalsha":case"eval_ro":case"evalsha_ro":case"fcall":case"fcall_ro":case"blmpop":case"bzmpop":E.push(...p(m,1));break;case"sintercard":case"lmpop":case"zunion":case"zinter":case"zmpop":case"zintercard":case"zdiff":{E.push(...p(m,0));break}case"georadius":{E.push(0);const x=R(m,5,"STORE");x&&E.push(x);const v=R(m,5,"STOREDIST");v&&E.push(v);break}case"georadiusbymember":{E.push(0);const x=R(m,4,"STORE");x&&E.push(x);const v=R(m,4,"STOREDIST");v&&E.push(v);break}case"sort":case"sort_ro":E.push(0);for(let x=1;x<m.length-1;x++){let v=m[x];if(typeof v!="string")continue;const M=v.toUpperCase();M==="GET"?(x+=1,v=m[x],v!=="#"&&(A?E.push([x,a(v)]):E.push(x))):M==="BY"?(x+=1,A?E.push([x,a(m[x])]):E.push(x)):M==="STORE"&&(x+=1,E.push(x))}break;case"migrate":if(m[2]==="")for(let x=5;x<m.length-1;x++){const v=m[x];if(typeof v=="string"&&v.toUpperCase()==="KEYS"){for(let M=x+1;M<m.length;M++)E.push(M);break}}else E.push(2);break;case"xreadgroup":case"xread":for(let x=h==="xread"?0:3;x<m.length-1;x++)if(String(m[x]).toUpperCase()==="STREAMS"){for(let v=x+1;v<=x+(m.length-1-x)/2;v++)E.push(v);break}break;default:if(w.step>0){const x=w.keyStart-1,v=w.keyStop>0?w.keyStop:m.length+w.keyStop+1;for(let M=x;M<v;M+=w.step)E.push(M)}break}return E}e.getKeyIndexes=u;function a(h){typeof h!="string"&&(h=String(h));const m=h.indexOf("->");return m===-1?h.length:m}})(St);const ma={},ba=Object.freeze(Object.defineProperty({__proto__:null,default:ma},Symbol.toStringTag,{value:"Module"})),J=Yr(ba);var lt={},pr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.tryCatch=e.errorObj=void 0,e.errorObj={e:{}};let t;function r(o,l){try{const u=t;return t=null,u.apply(this,arguments)}catch(u){return e.errorObj.e=u,e.errorObj}}function i(o){return t=o,r}e.tryCatch=i})(pr);Object.defineProperty(lt,"__esModule",{value:!0});const gt=pr;function Le(e){setTimeout(function(){throw e},0)}function Sa(e,t,r){return typeof t=="function"&&e.then(i=>{let o;r!==void 0&&Object(r).spread&&Array.isArray(i)?o=gt.tryCatch(t).apply(void 0,[null].concat(i)):o=i===void 0?gt.tryCatch(t)(null):gt.tryCatch(t)(null,i),o===gt.errorObj&&Le(o.e)},i=>{if(!i){const l=new Error(i+"");Object.assign(l,{cause:i}),i=l}const o=gt.tryCatch(t)(i);o===gt.errorObj&&Le(o.e)}),e}lt.default=Sa;var Ft={},Kt,ze;function ka(){if(ze)return Kt;ze=1;const e=J,t=J;function r(a){Object.defineProperty(this,"message",{value:a||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}t.inherits(r,Error),Object.defineProperty(r.prototype,"name",{value:"RedisError",configurable:!0,writable:!0});function i(a,h,m){e(h),e.strictEqual(typeof m,"number"),Object.defineProperty(this,"message",{value:a||"",configurable:!0,writable:!0});const g=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=g,this.offset=m,this.buffer=h}t.inherits(i,r),Object.defineProperty(i.prototype,"name",{value:"ParserError",configurable:!0,writable:!0});function o(a){Object.defineProperty(this,"message",{value:a||"",configurable:!0,writable:!0});const h=Error.stackTraceLimit;Error.stackTraceLimit=2,Error.captureStackTrace(this,this.constructor),Error.stackTraceLimit=h}t.inherits(o,r),Object.defineProperty(o.prototype,"name",{value:"ReplyError",configurable:!0,writable:!0});function l(a){Object.defineProperty(this,"message",{value:a||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}t.inherits(l,r),Object.defineProperty(l.prototype,"name",{value:"AbortError",configurable:!0,writable:!0});function u(a){Object.defineProperty(this,"message",{value:a||"",configurable:!0,writable:!0}),Error.captureStackTrace(this,this.constructor)}return t.inherits(u,l),Object.defineProperty(u.prototype,"name",{value:"InterruptError",configurable:!0,writable:!0}),Kt={RedisError:r,ParserError:i,ReplyError:o,AbortError:l,InterruptError:u},Kt}var Wt,Ge;function wa(){if(Ge)return Wt;Ge=1;const e=J;class t extends Error{get name(){return this.constructor.name}}class r extends t{constructor(a,h,m){e(h),e.strictEqual(typeof m,"number");const g=Error.stackTraceLimit;Error.stackTraceLimit=2,super(a),Error.stackTraceLimit=g,this.offset=m,this.buffer=h}get name(){return this.constructor.name}}class i extends t{constructor(a){const h=Error.stackTraceLimit;Error.stackTraceLimit=2,super(a),Error.stackTraceLimit=h}get name(){return this.constructor.name}}class o extends t{get name(){return this.constructor.name}}class l extends o{get name(){return this.constructor.name}}return Wt={RedisError:t,ParserError:r,ReplyError:i,AbortError:o,InterruptError:l},Wt}const va=process.version.charCodeAt(1)<55&&process.version.charCodeAt(2)===46?ka():wa();var kt=va,at={},he={exports:{}},qe=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920],xa=function(t){for(var r,i=0,o=0,l=[],u=t.length;i<u;i++)r=t.charCodeAt(i),r<128?l[o++]=r:r<2048?(l[o++]=r>>6|192,l[o++]=r&63|128):(r&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++i)&1023),l[o++]=r>>18|240,l[o++]=r>>12&63|128,l[o++]=r>>6&63|128,l[o++]=r&63|128):(l[o++]=r>>12|224,l[o++]=r>>6&63|128,l[o++]=r&63|128);return l},Ye=he.exports=function(t){for(var r,i=0,o=-1,l=0,u=0,a=typeof t=="string"?xa(t):t,h=a.length;i<h;){if(r=a[i++],o===-1)r===123&&(o=i);else if(r!==125)u=qe[(r^u>>8)&255]^u<<8;else if(i-1!==o)return u&16383;l=qe[(r^l>>8)&255]^l<<8}return l&16383};he.exports.generateMulti=function(t){for(var r=1,i=t.length,o=Ye(t[0]);r<i;)if(Ye(t[r++])!==o)return-1;return o};var pe=he.exports,X={},ot={},dr=9007199254740991,Ea="[object Arguments]",Ca="[object Function]",_a="[object GeneratorFunction]",Aa=/^(?:0|[1-9]\d*)$/;function yr(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function Ba(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var xt=Object.prototype,Et=xt.hasOwnProperty,gr=xt.toString,Ta=xt.propertyIsEnumerable,He=Math.max;function Ma(e,t){var r=Qa(e)||Ua(e)?Ba(e.length,String):[],i=r.length,o=!!i;for(var l in e)(t||Et.call(e,l))&&!(o&&(l=="length"||br(l,i)))&&r.push(l);return r}function Ra(e,t,r,i){return e===void 0||de(e,xt[r])&&!Et.call(i,r)?t:e}function Oa(e,t,r){var i=e[t];(!(Et.call(e,t)&&de(i,r))||r===void 0&&!(t in e))&&(e[t]=r)}function Fa(e){if(!ge(e))return ja(e);var t=Na(e),r=[];for(var i in e)i=="constructor"&&(t||!Et.call(e,i))||r.push(i);return r}function mr(e,t){return t=He(t===void 0?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=He(r.length-t,0),l=Array(o);++i<o;)l[i]=r[t+i];i=-1;for(var u=Array(t+1);++i<t;)u[i]=r[i];return u[t]=l,yr(e,this,u)}}function Ia(e,t,r,i){r||(r={});for(var o=-1,l=t.length;++o<l;){var u=t[o],a=i?i(r[u],e[u],u,r,e):void 0;Oa(r,u,a===void 0?e[u]:a)}return r}function Da(e){return mr(function(t,r){var i=-1,o=r.length,l=o>1?r[o-1]:void 0,u=o>2?r[2]:void 0;for(l=e.length>3&&typeof l=="function"?(o--,l):void 0,u&&Pa(r[0],r[1],u)&&(l=o<3?void 0:l,o=1),t=Object(t);++i<o;){var a=r[i];a&&e(t,a,i,l)}return t})}function br(e,t){return t=t??dr,!!t&&(typeof e=="number"||Aa.test(e))&&e>-1&&e%1==0&&e<t}function Pa(e,t,r){if(!ge(r))return!1;var i=typeof t;return(i=="number"?ye(r)&&br(t,r.length):i=="string"&&t in r)?de(r[t],e):!1}function Na(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||xt;return e===r}function ja(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}function de(e,t){return e===t||e!==e&&t!==t}function Ua(e){return La(e)&&Et.call(e,"callee")&&(!Ta.call(e,"callee")||gr.call(e)==Ea)}var Qa=Array.isArray;function ye(e){return e!=null&&Ga(e.length)&&!za(e)}function La(e){return qa(e)&&ye(e)}function za(e){var t=ge(e)?gr.call(e):"";return t==Ca||t==_a}function Ga(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=dr}function ge(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function qa(e){return!!e&&typeof e=="object"}var Ya=Da(function(e,t,r,i){Ia(t,Va(t),e,i)}),Ha=mr(function(e){return e.push(void 0,Ra),yr(Ya,void 0,e)});function Va(e){return ye(e)?Ma(e,!0):Fa(e)}var Ka=Ha,Wa=9007199254740991,Ja="[object Arguments]",Xa="[object Function]",Za="[object GeneratorFunction]",me=Object.prototype,$a=me.hasOwnProperty,Sr=me.toString,tc=me.propertyIsEnumerable;function ec(e){return nc(e)&&$a.call(e,"callee")&&(!tc.call(e,"callee")||Sr.call(e)==Ja)}function rc(e){return e!=null&&ic(e.length)&&!sc(e)}function nc(e){return ac(e)&&rc(e)}function sc(e){var t=oc(e)?Sr.call(e):"";return t==Xa||t==Za}function ic(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Wa}function oc(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function ac(e){return!!e&&typeof e=="object"}var cc=ec;Object.defineProperty(ot,"__esModule",{value:!0});ot.isArguments=ot.defaults=ot.noop=void 0;const lc=Ka;ot.defaults=lc;const uc=cc;ot.isArguments=uc;function fc(){}ot.noop=fc;var ct={},oe={exports:{}},Jt,Ve;function hc(){if(Ve)return Jt;Ve=1;var e=1e3,t=e*60,r=t*60,i=r*24,o=i*7,l=i*365.25;Jt=function(g,w){w=w||{};var E=typeof g;if(E==="string"&&g.length>0)return u(g);if(E==="number"&&isFinite(g))return w.long?h(g):a(g);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(g))};function u(g){if(g=String(g),!(g.length>100)){var w=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(g);if(w){var E=parseFloat(w[1]),A=(w[2]||"ms").toLowerCase();switch(A){case"years":case"year":case"yrs":case"yr":case"y":return E*l;case"weeks":case"week":case"w":return E*o;case"days":case"day":case"d":return E*i;case"hours":case"hour":case"hrs":case"hr":case"h":return E*r;case"minutes":case"minute":case"mins":case"min":case"m":return E*t;case"seconds":case"second":case"secs":case"sec":case"s":return E*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return E;default:return}}}}function a(g){var w=Math.abs(g);return w>=i?Math.round(g/i)+"d":w>=r?Math.round(g/r)+"h":w>=t?Math.round(g/t)+"m":w>=e?Math.round(g/e)+"s":g+"ms"}function h(g){var w=Math.abs(g);return w>=i?m(g,w,i,"day"):w>=r?m(g,w,r,"hour"):w>=t?m(g,w,t,"minute"):w>=e?m(g,w,e,"second"):g+" ms"}function m(g,w,E,A){var p=w>=E*1.5;return Math.round(g/E)+" "+A+(p?"s":"")}return Jt}function pc(e){r.debug=r,r.default=r,r.coerce=h,r.disable=l,r.enable=o,r.enabled=u,r.humanize=hc(),r.destroy=m,Object.keys(e).forEach(g=>{r[g]=e[g]}),r.names=[],r.skips=[],r.formatters={};function t(g){let w=0;for(let E=0;E<g.length;E++)w=(w<<5)-w+g.charCodeAt(E),w|=0;return r.colors[Math.abs(w)%r.colors.length]}r.selectColor=t;function r(g){let w,E=null,A,p;function R(...x){if(!R.enabled)return;const v=R,M=Number(new Date),d=M-(w||M);v.diff=d,v.prev=w,v.curr=M,w=M,x[0]=r.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let b=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(y,k)=>{if(y==="%%")return"%";b++;const C=r.formatters[k];if(typeof C=="function"){const O=x[b];y=C.call(v,O),x.splice(b,1),b--}return y}),r.formatArgs.call(v,x),(v.log||r.log).apply(v,x)}return R.namespace=g,R.useColors=r.useColors(),R.color=r.selectColor(g),R.extend=i,R.destroy=r.destroy,Object.defineProperty(R,"enabled",{enumerable:!0,configurable:!1,get:()=>E!==null?E:(A!==r.namespaces&&(A=r.namespaces,p=r.enabled(g)),p),set:x=>{E=x}}),typeof r.init=="function"&&r.init(R),R}function i(g,w){const E=r(this.namespace+(typeof w>"u"?":":w)+g);return E.log=this.log,E}function o(g){r.save(g),r.namespaces=g,r.names=[],r.skips=[];let w;const E=(typeof g=="string"?g:"").split(/[\s,]+/),A=E.length;for(w=0;w<A;w++)E[w]&&(g=E[w].replace(/\*/g,".*?"),g[0]==="-"?r.skips.push(new RegExp("^"+g.slice(1)+"$")):r.names.push(new RegExp("^"+g+"$")))}function l(){const g=[...r.names.map(a),...r.skips.map(a).map(w=>"-"+w)].join(",");return r.enable(""),g}function u(g){if(g[g.length-1]==="*")return!0;let w,E;for(w=0,E=r.skips.length;w<E;w++)if(r.skips[w].test(g))return!1;for(w=0,E=r.names.length;w<E;w++)if(r.names[w].test(g))return!0;return!1}function a(g){return g.toString().substring(2,g.toString().length-2).replace(/\.\*\?$/,"*")}function h(g){return g instanceof Error?g.stack||g.message:g}function m(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}var dc=pc;(function(e,t){t.formatArgs=i,t.save=o,t.load=l,t.useColors=r,t.storage=u(),t.destroy=(()=>{let h=!1;return()=>{h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const m="color: "+this.color;h.splice(1,0,m,"color: inherit");let g=0,w=0;h[0].replace(/%[a-zA-Z%]/g,E=>{E!=="%%"&&(g++,E==="%c"&&(w=g))}),h.splice(w,0,m)}t.log=console.debug||console.log||(()=>{});function o(h){try{h?t.storage.setItem("debug",h):t.storage.removeItem("debug")}catch{}}function l(){let h;try{h=t.storage.getItem("debug")}catch{}return!h&&typeof process<"u"&&"env"in process&&(h={}.DEBUG),h}function u(){try{return localStorage}catch{}}e.exports=dc(t);const{formatters:a}=e.exports;a.j=function(h){try{return JSON.stringify(h)}catch(m){return"[UnexpectedJSONParseError]: "+m.message}}})(oe,oe.exports);var yc=oe.exports;Object.defineProperty(ct,"__esModule",{value:!0});ct.genRedactedString=ct.getStringValue=ct.MAX_ARGUMENT_LENGTH=void 0;const gc=yc,ae=200;ct.MAX_ARGUMENT_LENGTH=ae;const mc="ioredis";function kr(e){if(e!==null)switch(typeof e){case"boolean":return;case"number":return;case"object":if(Buffer.isBuffer(e))return e.toString("hex");if(Array.isArray(e))return e.join(",");try{return JSON.stringify(e)}catch{return}case"string":return e}}ct.getStringValue=kr;function wr(e,t){const{length:r}=e;return r<=t?e:e.slice(0,t)+' ... <REDACTED full-length="'+r+'">'}ct.genRedactedString=wr;function bc(e){const t=(0,gc.default)(`${mc}:${e}`);function r(...i){if(t.enabled){for(let o=1;o<i.length;o++){const l=kr(i[o]);typeof l=="string"&&l.length>ae&&(i[o]=wr(l,ae))}return t.apply(null,i)}}return Object.defineProperties(r,{namespace:{get(){return t.namespace}},enabled:{get(){return t.enabled}},destroy:{get(){return t.destroy}},log:{get(){return t.log},set(i){t.log=i}}}),r}ct.default=bc;var be={};Object.defineProperty(be,"__esModule",{value:!0});const Ke=`-----BEGIN CERTIFICATE-----
MIIDTzCCAjegAwIBAgIJAKSVpiDswLcwMA0GCSqGSIb3DQEBBQUAMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTAeFw0xMzEwMDExMjE0NTVaFw0yMzA5MjkxMjE0NTVaMD4xFjAUBgNV
BAoMDUdhcmFudGlhIERhdGExJDAiBgNVBAMMG1NTTCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALZqkh/DczWP
JnxnHLQ7QL0T4B4CDKWBKCcisriGbA6ZePWVNo4hfKQC6JrzfR+081NeD6VcWUiz
rmd+jtPhIY4c+WVQYm5PKaN6DT1imYdxQw7aqO5j2KUCEh/cznpLxeSHoTxlR34E
QwF28Wl3eg2vc5ct8LjU3eozWVk3gb7alx9mSA2SgmuX5lEQawl++rSjsBStemY2
BDwOpAMXIrdEyP/cVn8mkvi/BDs5M5G+09j0gfhyCzRWMQ7Hn71u1eolRxwVxgi3
TMn+/vTaFSqxKjgck6zuAYjBRPaHe7qLxHNr1So/Mc9nPy+3wHebFwbIcnUojwbp
4nctkWbjb2cCAwEAAaNQME4wHQYDVR0OBBYEFP1whtcrydmW3ZJeuSoKZIKjze3w
MB8GA1UdIwQYMBaAFP1whtcrydmW3ZJeuSoKZIKjze3wMAwGA1UdEwQFMAMBAf8w
DQYJKoZIhvcNAQEFBQADggEBAG2erXhwRAa7+ZOBs0B6X57Hwyd1R4kfmXcs0rta
lbPpvgULSiB+TCbf3EbhJnHGyvdCY1tvlffLjdA7HJ0PCOn+YYLBA0pTU/dyvrN6
Su8NuS5yubnt9mb13nDGYo1rnt0YRfxN+8DM3fXIVr038A30UlPX2Ou1ExFJT0MZ
uFKY6ZvLdI6/1cbgmguMlAhM+DhKyV6Sr5699LM3zqeI816pZmlREETYkGr91q7k
BpXJu/dtHaGxg1ZGu6w/PCsYGUcECWENYD4VQPd8N32JjOfu6vEgoEAwfPP+3oGp
Z4m3ewACcWOAenqflb+cQYC4PsF7qbXDmRaWrbKntOlZ3n0=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIGMTCCBBmgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwajELMAkGA1UEBhMCVVMx
CzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJzMS0w
KwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcN
MTgwMjI1MTUzNzM3WhcNMjgwMjIzMTUzNzM3WjBfMQswCQYDVQQGEwJVUzELMAkG
A1UECAwCQ0ExEjAQBgNVBAoMCVJlZGlzTGFiczEvMC0GA1UEAwwmUkNQIEludGVy
bWVkaWF0ZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwggIiMA0GCSqGSIb3DQEBAQUA
A4ICDwAwggIKAoICAQDf9dqbxc8Bq7Ctq9rWcxrGNKKHivqLAFpPq02yLPx6fsOv
Tq7GsDChAYBBc4v7Y2Ap9RD5Vs3dIhEANcnolf27QwrG9RMnnvzk8pCvp1o6zSU4
VuOE1W66/O1/7e2rVxyrnTcP7UgK43zNIXu7+tiAqWsO92uSnuMoGPGpeaUm1jym
hjWKtkAwDFSqvHY+XL5qDVBEjeUe+WHkYUg40cAXjusAqgm2hZt29c2wnVrxW25W
P0meNlzHGFdA2AC5z54iRiqj57dTfBTkHoBczQxcyw6hhzxZQ4e5I5zOKjXXEhZN
r0tA3YC14CTabKRus/JmZieyZzRgEy2oti64tmLYTqSlAD78pRL40VNoaSYetXLw
hhNsXCHgWaY6d5bLOc/aIQMAV5oLvZQKvuXAF1IDmhPA+bZbpWipp0zagf1P1H3s
UzsMdn2KM0ejzgotbtNlj5TcrVwpmvE3ktvUAuA+hi3FkVx1US+2Gsp5x4YOzJ7u
P1WPk6ShF0JgnJH2ILdj6kttTWwFzH17keSFICWDfH/+kM+k7Y1v3EXMQXE7y0T9
MjvJskz6d/nv+sQhY04xt64xFMGTnZjlJMzfQNi7zWFLTZnDD0lPowq7l3YiPoTT
t5Xky83lu0KZsZBo0WlWaDG00gLVdtRgVbcuSWxpi5BdLb1kRab66JptWjxwXQID
AQABo4HrMIHoMDoGA1UdHwQzMDEwL6AtoCuGKWh0dHBzOi8vcmwtY2Etc2VydmVy
LnJlZGlzbGFicy5jb20vdjEvY3JsMEYGCCsGAQUFBwEBBDowODA2BggrBgEFBQcw
AYYqaHR0cHM6Ly9ybC1jYS1zZXJ2ZXIucmVkaXNsYWJzLmNvbS92MS9vY3NwMB0G
A1UdDgQWBBQHar5OKvQUpP2qWt6mckzToeCOHDAfBgNVHSMEGDAWgBQi42wH6hM4
L2sujEvLM0/u8lRXTzASBgNVHRMBAf8ECDAGAQH/AgEAMA4GA1UdDwEB/wQEAwIB
hjANBgkqhkiG9w0BAQsFAAOCAgEAirEn/iTsAKyhd+pu2W3Z5NjCko4NPU0EYUbr
AP7+POK2rzjIrJO3nFYQ/LLuC7KCXG+2qwan2SAOGmqWst13Y+WHp44Kae0kaChW
vcYLXXSoGQGC8QuFSNUdaeg3RbMDYFT04dOkqufeWVccoHVxyTSg9eD8LZuHn5jw
7QDLiEECBmIJHk5Eeo2TAZrx4Yx6ufSUX5HeVjlAzqwtAqdt99uCJ/EL8bgpWbe+
XoSpvUv0SEC1I1dCAhCKAvRlIOA6VBcmzg5Am12KzkqTul12/VEFIgzqu0Zy2Jbc
AUPrYVu/+tOGXQaijy7YgwH8P8n3s7ZeUa1VABJHcxrxYduDDJBLZi+MjheUDaZ1
jQRHYevI2tlqeSBqdPKG4zBY5lS0GiAlmuze5oENt0P3XboHoZPHiqcK3VECgTVh
/BkJcuudETSJcZDmQ8YfoKfBzRQNg2sv/hwvUv73Ss51Sco8GEt2lD8uEdib1Q6z
zDT5lXJowSzOD5ZA9OGDjnSRL+2riNtKWKEqvtEG3VBJoBzu9GoxbAc7wIZLxmli
iF5a/Zf5X+UXD3s4TMmy6C4QZJpAA2egsSQCnraWO2ULhh7iXMysSkF/nzVfZn43
iqpaB8++9a37hWq14ZmOv0TJIDz//b2+KC4VFXWQ5W5QC6whsjT+OlG4p5ZYG0jo
616pxqo=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFujCCA6KgAwIBAgIJAJ1aTT1lu2ScMA0GCSqGSIb3DQEBCwUAMGoxCzAJBgNV
BAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCQ0ExEjAQBgNVBAoMCVJlZGlz
TGFiczEtMCsGA1UEAwwkUmVkaXNMYWJzIFJvb3QgQ2VydGlmaWNhdGUgQXV0aG9y
aXR5MB4XDTE4MDIyNTE1MjA0MloXDTM4MDIyMDE1MjA0MlowajELMAkGA1UEBhMC
VVMxCzAJBgNVBAgMAkNBMQswCQYDVQQHDAJDQTESMBAGA1UECgwJUmVkaXNMYWJz
MS0wKwYDVQQDDCRSZWRpc0xhYnMgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkw
ggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDLEjXy7YrbN5Waau5cd6g1
G5C2tMmeTpZ0duFAPxNU4oE3RHS5gGiok346fUXuUxbZ6QkuzeN2/2Z+RmRcJhQY
Dm0ZgdG4x59An1TJfnzKKoWj8ISmoHS/TGNBdFzXV7FYNLBuqZouqePI6ReC6Qhl
pp45huV32Q3a6IDrrvx7Wo5ZczEQeFNbCeCOQYNDdTmCyEkHqc2AGo8eoIlSTutT
ULOC7R5gzJVTS0e1hesQ7jmqHjbO+VQS1NAL4/5K6cuTEqUl+XhVhPdLWBXJQ5ag
54qhX4v+ojLzeU1R/Vc6NjMvVtptWY6JihpgplprN0Yh2556ewcXMeturcKgXfGJ
xeYzsjzXerEjrVocX5V8BNrg64NlifzTMKNOOv4fVZszq1SIHR8F9ROrqiOdh8iC
JpUbLpXH9hWCSEO6VRMB2xJoKu3cgl63kF30s77x7wLFMEHiwsQRKxooE1UhgS9K
2sO4TlQ1eWUvFvHSTVDQDlGQ6zu4qjbOpb3Q8bQwoK+ai2alkXVR4Ltxe9QlgYK3
StsnPhruzZGA0wbXdpw0bnM+YdlEm5ffSTpNIfgHeaa7Dtb801FtA71ZlH7A6TaI
SIQuUST9EKmv7xrJyx0W1pGoPOLw5T029aTjnICSLdtV9bLwysrLhIYG5bnPq78B
cS+jZHFGzD7PUVGQD01nOQIDAQABo2MwYTAdBgNVHQ4EFgQUIuNsB+oTOC9rLoxL
yzNP7vJUV08wHwYDVR0jBBgwFoAUIuNsB+oTOC9rLoxLyzNP7vJUV08wDwYDVR0T
AQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQELBQADggIBAHfg
z5pMNUAKdMzK1aS1EDdK9yKz4qicILz5czSLj1mC7HKDRy8cVADUxEICis++CsCu
rYOvyCVergHQLREcxPq4rc5Nq1uj6J6649NEeh4WazOOjL4ZfQ1jVznMbGy+fJm3
3Hoelv6jWRG9iqeJZja7/1s6YC6bWymI/OY1e4wUKeNHAo+Vger7MlHV+RuabaX+
hSJ8bJAM59NCM7AgMTQpJCncrcdLeceYniGy5Q/qt2b5mJkQVkIdy4TPGGB+AXDJ
D0q3I/JDRkDUFNFdeW0js7fHdsvCR7O3tJy5zIgEV/o/BCkmJVtuwPYOrw/yOlKj
TY/U7ATAx9VFF6/vYEOMYSmrZlFX+98L6nJtwDqfLB5VTltqZ4H/KBxGE3IRSt9l
FXy40U+LnXzhhW+7VBAvyYX8GEXhHkKU8Gqk1xitrqfBXY74xKgyUSTolFSfFVgj
mcM/X4K45bka+qpkj7Kfv/8D4j6aZekwhN2ly6hhC1SmQ8qjMjpG/mrWOSSHZFmf
ybu9iD2AYHeIOkshIl6xYIa++Q/00/vs46IzAbQyriOi0XxlSMMVtPx0Q3isp+ji
n8Mq9eOuxYOEQ4of8twUkUDd528iwGtEdwf0Q01UyT84S62N8AySl1ZBKXJz6W4F
UhWfa/HQYOAPDdEjNgnVwLI23b8t0TozyCWw7q8h
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIEjzCCA3egAwIBAgIQe55B/ALCKJDZtdNT8kD6hTANBgkqhkiG9w0BAQsFADBM
MSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEGA1UEChMKR2xv
YmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjAeFw0yMjAxMjYxMjAwMDBaFw0y
NTAxMjYwMDAwMDBaMFgxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWdu
IG52LXNhMS4wLAYDVQQDEyVHbG9iYWxTaWduIEF0bGFzIFIzIE9WIFRMUyBDQSAy
MDIyIFEyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmGmg1LW9b7Lf
8zDD83yBDTEkt+FOxKJZqF4veWc5KZsQj9HfnUS2e5nj/E+JImlGPsQuoiosLuXD
BVBNAMcUFa11buFMGMeEMwiTmCXoXRrXQmH0qjpOfKgYc5gHG3BsRGaRrf7VR4eg
ofNMG9wUBw4/g/TT7+bQJdA4NfE7Y4d5gEryZiBGB/swaX6Jp/8MF4TgUmOWmalK
dZCKyb4sPGQFRTtElk67F7vU+wdGcrcOx1tDcIB0ncjLPMnaFicagl+daWGsKqTh
counQb6QJtYHa91KvCfKWocMxQ7OIbB5UARLPmC4CJ1/f8YFm35ebfzAeULYdGXu
jE9CLor0OwIDAQABo4IBXzCCAVswDgYDVR0PAQH/BAQDAgGGMB0GA1UdJQQWMBQG
CCsGAQUFBwMBBggrBgEFBQcDAjASBgNVHRMBAf8ECDAGAQH/AgEAMB0GA1UdDgQW
BBSH5Zq7a7B/t95GfJWkDBpA8HHqdjAfBgNVHSMEGDAWgBSP8Et/qC5FJK5NUPpj
move4t0bvDB7BggrBgEFBQcBAQRvMG0wLgYIKwYBBQUHMAGGImh0dHA6Ly9vY3Nw
Mi5nbG9iYWxzaWduLmNvbS9yb290cjMwOwYIKwYBBQUHMAKGL2h0dHA6Ly9zZWN1
cmUuZ2xvYmFsc2lnbi5jb20vY2FjZXJ0L3Jvb3QtcjMuY3J0MDYGA1UdHwQvMC0w
K6ApoCeGJWh0dHA6Ly9jcmwuZ2xvYmFsc2lnbi5jb20vcm9vdC1yMy5jcmwwIQYD
VR0gBBowGDAIBgZngQwBAgIwDAYKKwYBBAGgMgoBAjANBgkqhkiG9w0BAQsFAAOC
AQEAKRic9/f+nmhQU/wz04APZLjgG5OgsuUOyUEZjKVhNGDwxGTvKhyXGGAMW2B/
3bRi+aElpXwoxu3pL6fkElbX3B0BeS5LoDtxkyiVEBMZ8m+sXbocwlPyxrPbX6mY
0rVIvnuUeBH8X0L5IwfpNVvKnBIilTbcebfHyXkPezGwz7E1yhUULjJFm2bt0SdX
y+4X/WeiiYIv+fTVgZZgl+/2MKIsu/qdBJc3f3TvJ8nz+Eax1zgZmww+RSQWeOj3
15Iw6Z5FX+NwzY/Ab+9PosR5UosSeq+9HhtaxZttXG1nVh+avYPGYddWmiMT90J5
ZgKnO/Fx2hBgTxhOTMYaD312kg==
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----`,Sc={RedisCloudFixed:{ca:Ke},RedisCloudFlexible:{ca:Ke}};be.default=Sc;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.noop=e.defaults=e.Debug=e.zipMap=e.CONNECTION_CLOSED_ERROR_MSG=e.shuffle=e.sample=e.resolveTLSProfile=e.parseURL=e.optimizeErrorStack=e.toArg=e.convertMapToArray=e.convertObjectToArray=e.timeout=e.packObject=e.isInt=e.wrapMultiResult=e.convertBufferToString=void 0;const t=J,r=ot;Object.defineProperty(e,"defaults",{enumerable:!0,get:function(){return r.defaults}}),Object.defineProperty(e,"noop",{enumerable:!0,get:function(){return r.noop}});const i=ct;e.Debug=i.default;const o=be;function l(d,b){if(d instanceof Buffer)return d.toString(b);if(Array.isArray(d)){const B=d.length,y=Array(B);for(let k=0;k<B;++k)y[k]=d[k]instanceof Buffer&&b==="utf8"?d[k].toString():l(d[k],b);return y}return d}e.convertBufferToString=l;function u(d){if(!d)return null;const b=[],B=d.length;for(let y=0;y<B;++y){const k=d[y];k instanceof Error?b.push([k]):b.push([null,k])}return b}e.wrapMultiResult=u;function a(d){const b=parseFloat(d);return!isNaN(d)&&(b|0)===b}e.isInt=a;function h(d){const b={},B=d.length;for(let y=1;y<B;y+=2)b[d[y-1]]=d[y];return b}e.packObject=h;function m(d,b){let B=null;const y=function(){B&&(clearTimeout(B),B=null,d.apply(this,arguments))};return B=setTimeout(y,b,new Error("timeout")),y}e.timeout=m;function g(d){const b=[],B=Object.keys(d);for(let y=0,k=B.length;y<k;y++)b.push(B[y],d[B[y]]);return b}e.convertObjectToArray=g;function w(d){const b=[];let B=0;return d.forEach(function(y,k){b[B]=k,b[B+1]=y,B+=2}),b}e.convertMapToArray=w;function E(d){return d===null||typeof d>"u"?"":String(d)}e.toArg=E;function A(d,b,B){const y=b.split(`
`);let k="",C;for(C=1;C<y.length&&y[C].indexOf(B)!==-1;++C);for(let O=C;O<y.length;++O)k+=`
`+y[O];if(d.stack){const O=d.stack.indexOf(`
`);d.stack=d.stack.slice(0,O)+k}return d}e.optimizeErrorStack=A;function p(d){if(a(d))return{port:d};let b=(0,t.parse)(d,!0,!0);!b.slashes&&d[0]!=="/"&&(d="//"+d,b=(0,t.parse)(d,!0,!0));const B=b.query||{},y={};if(b.auth){const k=b.auth.indexOf(":");y.username=k===-1?b.auth:b.auth.slice(0,k),y.password=k===-1?"":b.auth.slice(k+1)}if(b.pathname&&(b.protocol==="redis:"||b.protocol==="rediss:"?b.pathname.length>1&&(y.db=b.pathname.slice(1)):y.path=b.pathname),b.host&&(y.host=b.hostname),b.port&&(y.port=b.port),typeof B.family=="string"){const k=Number.parseInt(B.family,10);Number.isNaN(k)||(y.family=k)}return(0,r.defaults)(y,B),y}e.parseURL=p;function R(d){let b=d==null?void 0:d.tls;typeof b=="string"&&(b={profile:b});const B=o.default[b==null?void 0:b.profile];return B&&(b=Object.assign({},B,b),delete b.profile,d=Object.assign({},d,{tls:b})),d}e.resolveTLSProfile=R;function x(d,b=0){const B=d.length;return b>=B?null:d[b+Math.floor(Math.random()*(B-b))]}e.sample=x;function v(d){let b=d.length;for(;b>0;){const B=Math.floor(Math.random()*b);b--,[d[b],d[B]]=[d[B],d[b]]}return d}e.shuffle=v,e.CONNECTION_CLOSED_ERROR_MSG="Connection is closed.";function M(d,b){const B=new Map;return d.forEach((y,k)=>{B.set(y,b[k])}),B}e.zipMap=M})(X);Object.defineProperty(at,"__esModule",{value:!0});const We=St,kc=pe,wc=lt,pt=X;class et{constructor(t,r=[],i={},o){if(this.name=t,this.inTransaction=!1,this.isResolved=!1,this.transformed=!1,this.replyEncoding=i.replyEncoding,this.errorStack=i.errorStack,this.args=r.flat(),this.callback=o,this.initPromise(),i.keyPrefix){const l=i.keyPrefix instanceof Buffer;let u=l?i.keyPrefix:null;this._iterateKeys(a=>a instanceof Buffer?(u===null&&(u=Buffer.from(i.keyPrefix)),Buffer.concat([u,a])):l?Buffer.concat([i.keyPrefix,Buffer.from(String(a))]):i.keyPrefix+a)}i.readOnly&&(this.isReadOnly=!0)}static checkFlag(t,r){return!!this.getFlagMap()[t][r]}static setArgumentTransformer(t,r){this._transformer.argument[t]=r}static setReplyTransformer(t,r){this._transformer.reply[t]=r}static getFlagMap(){return this.flagMap||(this.flagMap=Object.keys(et.FLAGS).reduce((t,r)=>(t[r]={},et.FLAGS[r].forEach(i=>{t[r][i]=!0}),t),{})),this.flagMap}getSlot(){if(typeof this.slot>"u"){const t=this.getKeys()[0];this.slot=t==null?null:kc(t)}return this.slot}getKeys(){return this._iterateKeys()}toWritable(t){let r;const i="*"+(this.args.length+1)+`\r
$`+Buffer.byteLength(this.name)+`\r
`+this.name+`\r
`;if(this.bufferMode){const o=new vc;o.push(i);for(let l=0;l<this.args.length;++l){const u=this.args[l];u instanceof Buffer?u.length===0?o.push(`$0\r
\r
`):(o.push("$"+u.length+`\r
`),o.push(u),o.push(`\r
`)):o.push("$"+Buffer.byteLength(u)+`\r
`+u+`\r
`)}r=o.toBuffer()}else{r=i;for(let o=0;o<this.args.length;++o){const l=this.args[o];r+="$"+Buffer.byteLength(l)+`\r
`+l+`\r
`}}return r}stringifyArguments(){for(let t=0;t<this.args.length;++t){const r=this.args[t];typeof r=="string"||(r instanceof Buffer?this.bufferMode=!0:this.args[t]=(0,pt.toArg)(r))}}transformReply(t){this.replyEncoding&&(t=(0,pt.convertBufferToString)(t,this.replyEncoding));const r=et._transformer.reply[this.name];return r&&(t=r(t)),t}setTimeout(t){this._commandTimeoutTimer||(this._commandTimeoutTimer=setTimeout(()=>{this.isResolved||this.reject(new Error("Command timed out"))},t))}initPromise(){const t=new Promise((r,i)=>{if(!this.transformed){this.transformed=!0;const o=et._transformer.argument[this.name];o&&(this.args=o(this.args)),this.stringifyArguments()}this.resolve=this._convertValue(r),this.errorStack?this.reject=o=>{i((0,pt.optimizeErrorStack)(o,this.errorStack.stack,__dirname))}:this.reject=i});this.promise=(0,wc.default)(t,this.callback)}_iterateKeys(t=r=>r){if(typeof this.keys>"u"&&(this.keys=[],(0,We.exists)(this.name))){const r=(0,We.getKeyIndexes)(this.name,this.args);for(const i of r)this.args[i]=t(this.args[i]),this.keys.push(this.args[i])}return this.keys}_convertValue(t){return r=>{try{const i=this._commandTimeoutTimer;i&&(clearTimeout(i),delete this._commandTimeoutTimer),t(this.transformReply(r)),this.isResolved=!0}catch(i){this.reject(i)}return this.promise}}}at.default=et;et.FLAGS={VALID_IN_SUBSCRIBER_MODE:["subscribe","psubscribe","unsubscribe","punsubscribe","ssubscribe","sunsubscribe","ping","quit"],VALID_IN_MONITOR_MODE:["monitor","auth"],ENTER_SUBSCRIBER_MODE:["subscribe","psubscribe","ssubscribe"],EXIT_SUBSCRIBER_MODE:["unsubscribe","punsubscribe","sunsubscribe"],WILL_DISCONNECT:["quit"]};et._transformer={argument:{},reply:{}};const vr=function(e){if(e.length===1){if(e[0]instanceof Map)return(0,pt.convertMapToArray)(e[0]);if(typeof e[0]=="object"&&e[0]!==null)return(0,pt.convertObjectToArray)(e[0])}return e},xr=function(e){if(e.length===2){if(e[1]instanceof Map)return[e[0]].concat((0,pt.convertMapToArray)(e[1]));if(typeof e[1]=="object"&&e[1]!==null)return[e[0]].concat((0,pt.convertObjectToArray)(e[1]))}return e};et.setArgumentTransformer("mset",vr);et.setArgumentTransformer("msetnx",vr);et.setArgumentTransformer("hset",xr);et.setArgumentTransformer("hmset",xr);et.setReplyTransformer("hgetall",function(e){if(Array.isArray(e)){const t={};for(let r=0;r<e.length;r+=2){const i=e[r],o=e[r+1];i in t?Object.defineProperty(t,i,{value:o,configurable:!0,enumerable:!0,writable:!0}):t[i]=o}return t}return e});class vc{constructor(){this.length=0,this.items=[]}push(t){this.length+=Buffer.byteLength(t),this.items.push(t)}toBuffer(){const t=Buffer.allocUnsafe(this.length);let r=0;for(const i of this.items){const o=Buffer.byteLength(i);Buffer.isBuffer(i)?i.copy(t,r):t.write(i,r,o),r+=o}return t}}var Se={};Object.defineProperty(Se,"__esModule",{value:!0});const xc=kt;class Er extends xc.RedisError{constructor(t,r){super(t),this.lastNodeError=r,Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}Se.default=Er;Er.defaultMessage="Failed to refresh slots cache.";var Ct={};Object.defineProperty(Ct,"__esModule",{value:!0});const Ec=J;class Cc extends Ec.Readable{constructor(t){super(t),this.opt=t,this._redisCursor="0",this._redisDrained=!1}_read(){if(this._redisDrained){this.push(null);return}const t=[this._redisCursor];this.opt.key&&t.unshift(this.opt.key),this.opt.match&&t.push("MATCH",this.opt.match),this.opt.type&&t.push("TYPE",this.opt.type),this.opt.count&&t.push("COUNT",String(this.opt.count)),this.opt.redis[this.opt.command](t,(r,i)=>{if(r){this.emit("error",r);return}this._redisCursor=i[0]instanceof Buffer?i[0].toString():i[0],this._redisCursor==="0"&&(this._redisDrained=!0),this.push(i[1])})}close(){this._redisDrained=!0}}Ct.default=Cc;var _t={},Ut={},At={},Cr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.executeWithAutoPipelining=e.getFirstValueInFlattenedArray=e.shouldUseAutoPipelining=e.notAllowedAutoPipelineCommands=e.kCallbacks=e.kExec=void 0;const t=ot,r=pe,i=lt;e.kExec=Symbol("exec"),e.kCallbacks=Symbol("callbacks"),e.notAllowedAutoPipelineCommands=["auth","info","script","quit","cluster","pipeline","multi","subscribe","psubscribe","unsubscribe","unpsubscribe","select"];function o(h,m){if(h._runningAutoPipelines.has(m)||!h._autoPipelines.has(m))return;h._runningAutoPipelines.add(m);const g=h._autoPipelines.get(m);h._autoPipelines.delete(m);const w=g[e.kCallbacks];g[e.kCallbacks]=null,g.exec(function(E,A){if(h._runningAutoPipelines.delete(m),E)for(let p=0;p<w.length;p++)process.nextTick(w[p],E);else for(let p=0;p<w.length;p++)process.nextTick(w[p],...A[p]);h._autoPipelines.has(m)&&o(h,m)})}function l(h,m,g){return m&&h.options.enableAutoPipelining&&!h.isPipeline&&!e.notAllowedAutoPipelineCommands.includes(g)&&!h.options.autoPipeliningIgnoredCommands.includes(g)}e.shouldUseAutoPipelining=l;function u(h){for(let m=0;m<h.length;m++){const g=h[m];if(typeof g=="string")return g;if(Array.isArray(g)||(0,t.isArguments)(g)){if(g.length===0)continue;return g[0]}const w=[g].flat();if(w.length>0)return w[0]}}e.getFirstValueInFlattenedArray=u;function a(h,m,g,w,E){if(h.isCluster&&!h.slots.length)return h.status==="wait"&&h.connect().catch(t.noop),(0,i.default)(new Promise(function(v,M){h.delayUntilReady(d=>{if(d){M(d);return}a(h,m,g,w,null).then(v,M)})}),E);const A=h.options.keyPrefix||"",p=h.isCluster?h.slots[r(`${A}${u(w)}`)].join(","):"main";if(!h._autoPipelines.has(p)){const v=h.pipeline();v[e.kExec]=!1,v[e.kCallbacks]=[],h._autoPipelines.set(p,v)}const R=h._autoPipelines.get(p);R[e.kExec]||(R[e.kExec]=!0,setImmediate(o,h,p));const x=new Promise(function(v,M){R[e.kCallbacks].push(function(d,b){if(d){M(d);return}v(b)}),m==="call"&&w.unshift(g),R[m](...w)});return(0,i.default)(x,E)}e.executeWithAutoPipelining=a})(Cr);var ke={};Object.defineProperty(ke,"__esModule",{value:!0});const _c=J,Ac=at,Bc=lt;class Tc{constructor(t,r=null,i="",o=!1){this.lua=t,this.numberOfKeys=r,this.keyPrefix=i,this.readOnly=o,this.sha=(0,_c.createHash)("sha1").update(t).digest("hex");const l=this.sha,u=new WeakSet;this.Command=class extends Ac.default{toWritable(h){const m=this.reject;return this.reject=g=>{g.message.indexOf("NOSCRIPT")!==-1&&u.delete(h),m.call(this,g)},u.has(h)?this.name==="eval"&&(this.name="evalsha",this.args[0]=l):(u.add(h),this.name="eval",this.args[0]=t),super.toWritable(h)}}}execute(t,r,i,o){typeof this.numberOfKeys=="number"&&r.unshift(this.numberOfKeys),this.keyPrefix&&(i.keyPrefix=this.keyPrefix),this.readOnly&&(i.readOnly=!0);const l=new this.Command("evalsha",[this.sha,...r],i);return l.promise=l.promise.catch(u=>{if(u.message.indexOf("NOSCRIPT")===-1)throw u;const a=new this.Command("evalsha",[this.sha,...r],i);return(t.isPipeline?t.redis:t).sendCommand(a)}),(0,Bc.default)(l.promise,o),t.sendCommand(l)}}ke.default=Tc;Object.defineProperty(At,"__esModule",{value:!0});const Mc=St,Pt=Cr,Rc=at,Oc=ke;class yt{constructor(){this.options={},this.scriptsSet={},this.addedBuiltinSet=new Set}getBuiltinCommands(){return we.slice(0)}createBuiltinCommand(t){return{string:ut(null,t,"utf8"),buffer:ut(null,t,null)}}addBuiltinCommand(t){this.addedBuiltinSet.add(t),this[t]=ut(t,t,"utf8"),this[t+"Buffer"]=ut(t+"Buffer",t,null)}defineCommand(t,r){const i=new Oc.default(r.lua,r.numberOfKeys,this.options.keyPrefix,r.readOnly);this.scriptsSet[t]=i,this[t]=Je(t,t,i,"utf8"),this[t+"Buffer"]=Je(t+"Buffer",t,i,null)}sendCommand(t,r,i){throw new Error('"sendCommand" is not implemented')}}const we=Mc.list.filter(e=>e!=="monitor");we.push("sentinel");we.forEach(function(e){yt.prototype[e]=ut(e,e,"utf8"),yt.prototype[e+"Buffer"]=ut(e+"Buffer",e,null)});yt.prototype.call=ut("call","utf8");yt.prototype.callBuffer=ut("callBuffer",null);yt.prototype.send_command=yt.prototype.call;function ut(e,t,r){return typeof r>"u"&&(r=t,t=null),function(...i){const o=t||i.shift();let l=i[i.length-1];typeof l=="function"?i.pop():l=void 0;const u={errorStack:this.options.showFriendlyErrorStack?new Error:void 0,keyPrefix:this.options.keyPrefix,replyEncoding:r};return(0,Pt.shouldUseAutoPipelining)(this,e,o)?(0,Pt.executeWithAutoPipelining)(this,e,o,i,l):this.sendCommand(new Rc.default(o,i,u,l))}}function Je(e,t,r,i){return function(...o){const l=typeof o[o.length-1]=="function"?o.pop():void 0,u={replyEncoding:i};return this.options.showFriendlyErrorStack&&(u.errorStack=new Error),(0,Pt.shouldUseAutoPipelining)(this,e,t)?(0,Pt.executeWithAutoPipelining)(this,e,t,o,l):r.execute(this,o,u,l)}}At.default=yt;Object.defineProperty(Ut,"__esModule",{value:!0});const ce=pe,Xe=St,Ze=lt,Fc=J,Ic=at,Dc=X,Pc=At;function Nc(e,t){const r=ce(t[0]),i=e._groupsBySlot[r];for(let o=1;o<t.length;o++)if(e._groupsBySlot[ce(t[o])]!==i)return-1;return r}class wt extends Pc.default{constructor(t){super(),this.redis=t,this.isPipeline=!0,this.replyPending=0,this._queue=[],this._result=[],this._transactions=0,this._shaToScript={},this.isCluster=this.redis.constructor.name==="Cluster"||this.redis.isCluster,this.options=t.options,Object.keys(t.scriptsSet).forEach(i=>{const o=t.scriptsSet[i];this._shaToScript[o.sha]=o,this[i]=t[i],this[i+"Buffer"]=t[i+"Buffer"]}),t.addedBuiltinSet.forEach(i=>{this[i]=t[i],this[i+"Buffer"]=t[i+"Buffer"]}),this.promise=new Promise((i,o)=>{this.resolve=i,this.reject=o});const r=this;Object.defineProperty(this,"length",{get:function(){return r._queue.length}})}fillResult(t,r){if(this._queue[r].name==="exec"&&Array.isArray(t[1])){const o=t[1].length;for(let l=0;l<o;l++){if(t[1][l]instanceof Error)continue;const u=this._queue[r-(o-l)];try{t[1][l]=u.transformReply(t[1][l])}catch(a){t[1][l]=a}}}if(this._result[r]=t,--this.replyPending)return;if(this.isCluster){let o=!0,l;for(let u=0;u<this._result.length;++u){const a=this._result[u][0],h=this._queue[u];if(a){if(h.name==="exec"&&a.message==="EXECABORT Transaction discarded because of previous errors.")continue;if(!l)l={name:a.name,message:a.message};else if(l.name!==a.name||l.message!==a.message){o=!1;break}}else if(!h.inTransaction&&!((0,Xe.exists)(h.name)&&(0,Xe.hasFlag)(h.name,"readonly"))){o=!1;break}}if(l&&o){const u=this,a=l.message.split(" "),h=this._queue;let m=!1;this._queue=[];for(let A=0;A<h.length;++A){if(a[0]==="ASK"&&!m&&h[A].name!=="asking"&&(!h[A-1]||h[A-1].name!=="asking")){const p=new Ic.default("asking");p.ignore=!0,this.sendCommand(p)}h[A].initPromise(),this.sendCommand(h[A]),m=h[A].inTransaction}let g=!0;typeof this.leftRedirections>"u"&&(this.leftRedirections={});const w=function(){u.exec()},E=this.redis;if(E.handleError(l,this.leftRedirections,{moved:function(A,p){u.preferKey=p,E.slots[a[1]]=[p],E._groupsBySlot[a[1]]=E._groupsIds[E.slots[a[1]].join(";")],E.refreshSlotsCache(),u.exec()},ask:function(A,p){u.preferKey=p,u.exec()},tryagain:w,clusterDown:w,connectionClosed:w,maxRedirections:()=>{g=!1},defaults:()=>{g=!1}}),g)return}}let i=0;for(let o=0;o<this._queue.length-i;++o)this._queue[o+i].ignore&&(i+=1),this._result[o]=this._result[o+i];this.resolve(this._result.slice(0,this._result.length-i))}sendCommand(t){this._transactions>0&&(t.inTransaction=!0);const r=this._queue.length;return t.pipelineIndex=r,t.promise.then(i=>{this.fillResult([null,i],r)}).catch(i=>{this.fillResult([i],r)}),this._queue.push(t),this}addBatch(t){let r,i,o;for(let l=0;l<t.length;++l)r=t[l],i=r[0],o=r.slice(1),this[i].apply(this,o);return this}}Ut.default=wt;const jc=wt.prototype.multi;wt.prototype.multi=function(){return this._transactions+=1,jc.apply(this,arguments)};const _r=wt.prototype.execBuffer;wt.prototype.execBuffer=(0,Fc.deprecate)(function(){return this._transactions>0&&(this._transactions-=1),_r.apply(this,arguments)},"Pipeline#execBuffer: Use Pipeline#exec instead");wt.prototype.exec=function(e){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(Dc.noop),e&&!this.nodeifiedPromise&&(this.nodeifiedPromise=!0,(0,Ze.default)(this.promise,e)),this.redis.delayUntilReady(o=>{if(o){this.reject(o);return}this.exec(e)}),this.promise;if(this._transactions>0)return this._transactions-=1,_r.apply(this,arguments);this.nodeifiedPromise||(this.nodeifiedPromise=!0,(0,Ze.default)(this.promise,e)),this._queue.length||this.resolve([]);let t;if(this.isCluster){const o=[];for(let l=0;l<this._queue.length;l++){const u=this._queue[l].getKeys();if(u.length&&o.push(u[0]),u.length&&ce.generateMulti(u)<0)return this.reject(new Error("All the keys in a pipeline command should belong to the same slot")),this.promise}if(o.length){if(t=Nc(this.redis,o),t<0)return this.reject(new Error("All keys in the pipeline should belong to the same slots allocation group")),this.promise}else t=Math.random()*16384|0}const r=this;return i(),this.promise;function i(){let o=r.replyPending=r._queue.length,l;r.isCluster&&(l={slot:t,redis:r.redis.connectionPool.nodes.all[r.preferKey]});let u="",a;const h={isPipeline:!0,destination:r.isCluster?l:{redis:r.redis},write(m){typeof m!="string"?(a||(a=[]),u&&(a.push(Buffer.from(u,"utf8")),u=""),a.push(m)):u+=m,--o||(a?(u&&a.push(Buffer.from(u,"utf8")),h.destination.redis.stream.write(Buffer.concat(a))):h.destination.redis.stream.write(u),o=r._queue.length,u="",a=void 0)}};for(let m=0;m<r._queue.length;++m)r.redis.sendCommand(r._queue[m],h,l);return r.promise}};Object.defineProperty(_t,"__esModule",{value:!0});_t.addTransactionSupport=void 0;const Xt=X,Zt=lt,$e=Ut;function Uc(e){e.pipeline=function(i){const o=new $e.default(this);return Array.isArray(i)&&o.addBatch(i),o};const{multi:t}=e;e.multi=function(i,o){if(typeof o>"u"&&!Array.isArray(i)&&(o=i,i=null),o&&o.pipeline===!1)return t.call(this);const l=new $e.default(this);l.multi(),Array.isArray(i)&&l.addBatch(i);const u=l.exec;l.exec=function(h){if(this.isCluster&&!this.redis.slots.length)return this.redis.status==="wait"&&this.redis.connect().catch(Xt.noop),(0,Zt.default)(new Promise((g,w)=>{this.redis.delayUntilReady(E=>{if(E){w(E);return}this.exec(l).then(g,w)})}),h);if(this._transactions>0&&u.call(l),this.nodeifiedPromise)return u.call(l);const m=u.call(l);return(0,Zt.default)(m.then(function(g){const w=g[g.length-1];if(typeof w>"u")throw new Error("Pipeline cannot be used to send any commands when the `exec()` has been called on it.");if(w[0]){w[0].previousErrors=[];for(let E=0;E<g.length-1;++E)g[E][0]&&w[0].previousErrors.push(g[E][0]);throw w[0]}return(0,Xt.wrapMultiResult)(w[1])}),h)};const{execBuffer:a}=l;return l.execBuffer=function(h){return this._transactions>0&&a.call(l),l.exec(h)},l};const{exec:r}=e;e.exec=function(i){return(0,Zt.default)(r.call(this).then(function(o){return Array.isArray(o)&&(o=(0,Xt.wrapMultiResult)(o)),o}),i)}}_t.addTransactionSupport=Uc;var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});function Qc(e,t){Object.getOwnPropertyNames(t.prototype).forEach(r=>{Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r))})}Qt.default=Qc;var Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.DEFAULT_CLUSTER_OPTIONS=void 0;const tr=J;Lt.DEFAULT_CLUSTER_OPTIONS={clusterRetryStrategy:e=>Math.min(100+e*2,2e3),enableOfflineQueue:!0,enableReadyCheck:!0,scaleReads:"master",maxRedirections:16,retryDelayOnMoved:0,retryDelayOnFailover:100,retryDelayOnClusterDown:100,retryDelayOnTryAgain:100,slotsRefreshTimeout:1e3,useSRVRecords:!1,resolveSrv:tr.resolveSrv,dnsLookup:tr.lookup,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[]};var It={},K={};Object.defineProperty(K,"__esModule",{value:!0});K.getConnectionName=K.weightSrvRecords=K.groupSrvRecords=K.getUniqueHostnamesFromOptions=K.normalizeNodeOptions=K.nodeKeyToRedisOptions=K.getNodeKey=void 0;const er=X,Lc=J;function zc(e){return e.port=e.port||6379,e.host=e.host||"127.0.0.1",e.host+":"+e.port}K.getNodeKey=zc;function Gc(e){const t=e.lastIndexOf(":");if(t===-1)throw new Error(`Invalid node key ${e}`);return{host:e.slice(0,t),port:Number(e.slice(t+1))}}K.nodeKeyToRedisOptions=Gc;function qc(e){return e.map(t=>{const r={};if(typeof t=="object")Object.assign(r,t);else if(typeof t=="string")Object.assign(r,(0,er.parseURL)(t));else if(typeof t=="number")r.port=t;else throw new Error("Invalid argument "+t);return typeof r.port=="string"&&(r.port=parseInt(r.port,10)),delete r.db,r.port||(r.port=6379),r.host||(r.host="127.0.0.1"),(0,er.resolveTLSProfile)(r)})}K.normalizeNodeOptions=qc;function Yc(e){const t={};return e.forEach(r=>{t[r.host]=!0}),Object.keys(t).filter(r=>!(0,Lc.isIP)(r))}K.getUniqueHostnamesFromOptions=Yc;function Hc(e){const t={};for(const r of e)t.hasOwnProperty(r.priority)?(t[r.priority].totalWeight+=r.weight,t[r.priority].records.push(r)):t[r.priority]={totalWeight:r.weight,records:[r]};return t}K.groupSrvRecords=Hc;function Vc(e){if(e.records.length===1)return e.totalWeight=0,e.records.shift();const t=Math.floor(Math.random()*(e.totalWeight+e.records.length));let r=0;for(const[i,o]of e.records.entries())if(r+=1+o.weight,r>t)return e.totalWeight-=o.weight,e.records.splice(i,1),o}K.weightSrvRecords=Vc;function Kc(e,t){const r=`ioredis-cluster(${e})`;return t?`${r}:${t}`:r}K.getConnectionName=Kc;var rr;function Wc(){if(rr)return It;rr=1,Object.defineProperty(It,"__esModule",{value:!0});const e=K,t=X,r=dt(),i=(0,t.Debug)("cluster:subscriber");let o=class{constructor(u,a){this.connectionPool=u,this.emitter=a,this.started=!1,this.subscriber=null,this.onSubscriberEnd=()=>{if(!this.started){i("subscriber has disconnected, but ClusterSubscriber is not started, so not reconnecting.");return}i("subscriber has disconnected, selecting a new one..."),this.selectSubscriber()},this.connectionPool.on("-node",(h,m)=>{!this.started||!this.subscriber||(0,e.getNodeKey)(this.subscriber.options)===m&&(i("subscriber has left, selecting a new one..."),this.selectSubscriber())}),this.connectionPool.on("+node",()=>{!this.started||this.subscriber||(i("a new node is discovered and there is no subscriber, selecting a new one..."),this.selectSubscriber())})}getInstance(){return this.subscriber}start(){this.started=!0,this.selectSubscriber(),i("started")}stop(){this.started=!1,this.subscriber&&(this.subscriber.disconnect(),this.subscriber=null),i("stopped")}selectSubscriber(){const u=this.lastActiveSubscriber;u&&(u.off("end",this.onSubscriberEnd),u.disconnect()),this.subscriber&&(this.subscriber.off("end",this.onSubscriberEnd),this.subscriber.disconnect());const a=(0,t.sample)(this.connectionPool.getNodes());if(!a){i("selecting subscriber failed since there is no node discovered in the cluster yet"),this.subscriber=null;return}const{options:h}=a;i("selected a subscriber %s:%s",h.host,h.port),this.subscriber=new r.default({port:h.port,host:h.host,username:h.username,password:h.password,enableReadyCheck:!0,connectionName:(0,e.getConnectionName)("subscriber",h.connectionName),lazyConnect:!0,tls:h.tls,retryStrategy:null}),this.subscriber.on("error",t.noop),this.subscriber.once("end",this.onSubscriberEnd);const m={subscribe:[],psubscribe:[],ssubscribe:[]};if(u){const g=u.condition||u.prevCondition;g&&g.subscriber&&(m.subscribe=g.subscriber.channels("subscribe"),m.psubscribe=g.subscriber.channels("psubscribe"),m.ssubscribe=g.subscriber.channels("ssubscribe"))}if(m.subscribe.length||m.psubscribe.length||m.ssubscribe.length){let g=0;for(const w of["subscribe","psubscribe","ssubscribe"]){const E=m[w];E.length&&(g+=1,i("%s %d channels",w,E.length),this.subscriber[w](E).then(()=>{--g||(this.lastActiveSubscriber=this.subscriber)}).catch(()=>{i("failed to %s %d channels",w,E.length)}))}}else this.lastActiveSubscriber=this.subscriber;for(const g of["message","messageBuffer","smessage","smessageBuffer"])this.subscriber.on(g,(w,E)=>{this.emitter.emit(g,w,E)});for(const g of["pmessage","pmessageBuffer"])this.subscriber.on(g,(w,E,A)=>{this.emitter.emit(g,w,E,A)})}};return It.default=o,It}var Dt={},nr;function Jc(){if(nr)return Dt;nr=1,Object.defineProperty(Dt,"__esModule",{value:!0});const e=J,t=X,r=K,i=dt(),o=(0,t.Debug)("cluster:connectionPool");let l=class extends e.EventEmitter{constructor(a){super(),this.redisOptions=a,this.nodes={all:{},master:{},slave:{}},this.specifiedOptions={}}getNodes(a="all"){const h=this.nodes[a];return Object.keys(h).map(m=>h[m])}getInstanceByKey(a){return this.nodes.all[a]}getSampleInstance(a){const h=Object.keys(this.nodes[a]),m=(0,t.sample)(h);return this.nodes[a][m]}findOrCreate(a,h=!1){const m=(0,r.getNodeKey)(a);h=!!h,this.specifiedOptions[m]?Object.assign(a,this.specifiedOptions[m]):this.specifiedOptions[m]=a;let g;return this.nodes.all[m]?(g=this.nodes.all[m],g.options.readOnly!==h&&(g.options.readOnly=h,o("Change role of %s to %s",m,h?"slave":"master"),g[h?"readonly":"readwrite"]().catch(t.noop),h?(delete this.nodes.master[m],this.nodes.slave[m]=g):(delete this.nodes.slave[m],this.nodes.master[m]=g))):(o("Connecting to %s as %s",m,h?"slave":"master"),g=new i.default((0,t.defaults)({retryStrategy:null,enableOfflineQueue:!0,readOnly:h},a,this.redisOptions,{lazyConnect:!0})),this.nodes.all[m]=g,this.nodes[h?"slave":"master"][m]=g,g.once("end",()=>{this.removeNode(m),this.emit("-node",g,m),Object.keys(this.nodes.all).length||this.emit("drain")}),this.emit("+node",g,m),g.on("error",function(w){this.emit("nodeError",w,m)})),g}reset(a){o("Reset with %O",a);const h={};a.forEach(m=>{const g=(0,r.getNodeKey)(m);m.readOnly&&h[g]||(h[g]=m)}),Object.keys(this.nodes.all).forEach(m=>{h[m]||(o("Disconnect %s because the node does not hold any slot",m),this.nodes.all[m].disconnect(),this.removeNode(m))}),Object.keys(h).forEach(m=>{const g=h[m];this.findOrCreate(g,g.readOnly)})}removeNode(a){const{nodes:h}=this;h.all[a]&&(o("Remove %s from the pool",a),delete h.all[a]),delete h.master[a],delete h.slave[a]}};return Dt.default=l,Dt}var ve={};function Y(e,r){var r=r||{};this._capacity=r.capacity,this._head=0,this._tail=0,Array.isArray(e)?this._fromArray(e):(this._capacityMask=3,this._list=new Array(4))}Y.prototype.peekAt=function(t){var r=t;if(r===(r|0)){var i=this.size();if(!(r>=i||r<-i))return r<0&&(r+=i),r=this._head+r&this._capacityMask,this._list[r]}};Y.prototype.get=function(t){return this.peekAt(t)};Y.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};Y.prototype.peekFront=function(){return this.peek()};Y.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(Y.prototype,"length",{get:function(){return this.size()}});Y.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Y.prototype.unshift=function(t){if(arguments.length===0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=t,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Y.prototype.shift=function(){var t=this._head;if(t!==this._tail){var r=this._list[t];return this._list[t]=void 0,this._head=t+1&this._capacityMask,t<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};Y.prototype.push=function(t){if(arguments.length===0)return this.size();var r=this._tail;return this._list[r]=t,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Y.prototype.pop=function(){var t=this._tail;if(t!==this._head){var r=this._list.length;this._tail=t-1+r&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&t>1e4&&t<=r>>>2&&this._shrinkArray(),i}};Y.prototype.removeOne=function(t){var r=t;if(r===(r|0)&&this._head!==this._tail){var i=this.size(),o=this._list.length;if(!(r>=i||r<-i)){r<0&&(r+=i),r=this._head+r&this._capacityMask;var l=this._list[r],u;if(t<i/2){for(u=t;u>0;u--)this._list[r]=this._list[r=r-1+o&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+o&this._capacityMask}else{for(u=i-1-t;u>0;u--)this._list[r]=this._list[r=r+1+o&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+o&this._capacityMask}return l}}};Y.prototype.remove=function(t,r){var i=t,o,l=r;if(i===(i|0)&&this._head!==this._tail){var u=this.size(),a=this._list.length;if(!(i>=u||i<-u||r<1)){if(i<0&&(i+=u),r===1||!r)return o=new Array(1),o[0]=this.removeOne(i),o;if(i===0&&i+r>=u)return o=this.toArray(),this.clear(),o;i+r>u&&(r=u-i);var h;for(o=new Array(r),h=0;h<r;h++)o[h]=this._list[this._head+i+h&this._capacityMask];if(i=this._head+i&this._capacityMask,t+r===u){for(this._tail=this._tail-r+a&this._capacityMask,h=r;h>0;h--)this._list[i=i+1+a&this._capacityMask]=void 0;return o}if(t===0){for(this._head=this._head+r+a&this._capacityMask,h=r-1;h>0;h--)this._list[i=i+1+a&this._capacityMask]=void 0;return o}if(i<u/2){for(this._head=this._head+t+r+a&this._capacityMask,h=t;h>0;h--)this.unshift(this._list[i=i-1+a&this._capacityMask]);for(i=this._head-1+a&this._capacityMask;l>0;)this._list[i=i-1+a&this._capacityMask]=void 0,l--;t<0&&(this._tail=i)}else{for(this._tail=i,i=i+r+a&this._capacityMask,h=u-(r+t);h>0;h--)this.push(this._list[i++]);for(i=this._tail;l>0;)this._list[i=i+1+a&this._capacityMask]=void 0,l--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),o}}};Y.prototype.splice=function(t,r){var i=t;if(i===(i|0)){var o=this.size();if(i<0&&(i+=o),!(i>o))if(arguments.length>2){var l,u,a,h=arguments.length,m=this._list.length,g=2;if(!o||i<o/2){for(u=new Array(i),l=0;l<i;l++)u[l]=this._list[this._head+l&this._capacityMask];for(r===0?(a=[],i>0&&(this._head=this._head+i+m&this._capacityMask)):(a=this.remove(i,r),this._head=this._head+i+m&this._capacityMask);h>g;)this.unshift(arguments[--h]);for(l=i;l>0;l--)this.unshift(u[l-1])}else{u=new Array(o-(i+r));var w=u.length;for(l=0;l<w;l++)u[l]=this._list[this._head+i+r+l&this._capacityMask];for(r===0?(a=[],i!=o&&(this._tail=this._head+i+m&this._capacityMask)):(a=this.remove(i,r),this._tail=this._tail-w+m&this._capacityMask);g<h;)this.push(arguments[g++]);for(l=0;l<w;l++)this.push(u[l])}return a}else return this.remove(i,r)}};Y.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0};Y.prototype.isEmpty=function(){return this._head===this._tail};Y.prototype.toArray=function(){return this._copyArray(!1)};Y.prototype._fromArray=function(t){var r=t.length,i=this._nextPowerOf2(r);this._list=new Array(i),this._capacityMask=i-1,this._tail=r;for(var o=0;o<r;o++)this._list[o]=t[o]};Y.prototype._copyArray=function(t,r){var i=this._list,o=i.length,l=this.length;if(r=r|l,r==l&&this._head<this._tail)return this._list.slice(this._head,this._tail);var u=new Array(r),a=0,h;if(t||this._head>this._tail){for(h=this._head;h<o;h++)u[a++]=i[h];for(h=0;h<this._tail;h++)u[a++]=i[h]}else for(h=this._head;h<this._tail;h++)u[a++]=i[h];return u};Y.prototype._growArray=function(){if(this._head!=0){var t=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=t}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1};Y.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Y.prototype._nextPowerOf2=function(t){var r=Math.log(t)/Math.log(2),i=1<<r+1;return Math.max(i,4)};var xe=Y;Object.defineProperty(ve,"__esModule",{value:!0});const Xc=X,Zc=xe,$c=(0,Xc.Debug)("delayqueue");class tl{constructor(){this.queues={},this.timeouts={}}push(t,r,i){const o=i.callback||process.nextTick;this.queues[t]||(this.queues[t]=new Zc),this.queues[t].push(r),this.timeouts[t]||(this.timeouts[t]=setTimeout(()=>{o(()=>{this.timeouts[t]=null,this.execute(t)})},i.timeout))}execute(t){const r=this.queues[t];if(!r)return;const{length:i}=r;if(i)for($c("send %d commands in %s queue",i,t),this.queues[t]=null;r.length>0;)r.shift()()}}ve.default=tl;var sr;function Ar(){if(sr)return Ft;sr=1,Object.defineProperty(Ft,"__esModule",{value:!0});const e=St,t=J,r=kt,i=lt,o=at,l=Se,u=dt(),a=Ct,h=_t,m=X,g=Qt,w=At,E=Lt,A=Wc(),p=Jc(),R=ve,x=K,v=xe,M=(0,m.Debug)("cluster"),d=new WeakSet;class b extends w.default{constructor(y,k={}){if(super(),this.slots=[],this._groupsIds={},this._groupsBySlot=Array(16384),this.isCluster=!0,this.retryAttempts=0,this.delayQueue=new R.default,this.offlineQueue=new v,this.isRefreshing=!1,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this._readyDelayedCallbacks=[],this.connectionEpoch=0,t.EventEmitter.call(this),this.startupNodes=y,this.options=(0,m.defaults)({},k,E.DEFAULT_CLUSTER_OPTIONS,this.options),this.options.redisOptions&&this.options.redisOptions.keyPrefix&&!this.options.keyPrefix&&(this.options.keyPrefix=this.options.redisOptions.keyPrefix),typeof this.options.scaleReads!="function"&&["all","master","slave"].indexOf(this.options.scaleReads)===-1)throw new Error('Invalid option scaleReads "'+this.options.scaleReads+'". Expected "all", "master", "slave" or a custom function');this.connectionPool=new p.default(this.options.redisOptions),this.connectionPool.on("-node",(C,O)=>{this.emit("-node",C)}),this.connectionPool.on("+node",C=>{this.emit("+node",C)}),this.connectionPool.on("drain",()=>{this.setStatus("close")}),this.connectionPool.on("nodeError",(C,O)=>{this.emit("node error",C,O)}),this.subscriber=new A.default(this.connectionPool,this),this.options.scripts&&Object.entries(this.options.scripts).forEach(([C,O])=>{this.defineCommand(C,O)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(C=>{M("connecting failed: %s",C)})}connect(){return new Promise((y,k)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){k(new Error("Redis is already connecting/connected"));return}const C=++this.connectionEpoch;this.setStatus("connecting"),this.resolveStartupNodeHostnames().then(O=>{if(this.connectionEpoch!==C){M("discard connecting after resolving startup nodes because epoch not match: %d != %d",C,this.connectionEpoch),k(new r.RedisError("Connection is discarded because a new connection is made"));return}if(this.status!=="connecting"){M("discard connecting after resolving startup nodes because the status changed to %s",this.status),k(new r.RedisError("Connection is aborted"));return}this.connectionPool.reset(O);const F=()=>{this.setStatus("ready"),this.retryAttempts=0,this.executeOfflineCommands(),this.resetNodesRefreshInterval(),y()};let U;const I=()=>{this.invokeReadyDelayedCallbacks(void 0),this.removeListener("close",U),this.manuallyClosing=!1,this.setStatus("connect"),this.options.enableReadyCheck?this.readyCheck((D,P)=>{D||P?(M("Ready check failed (%s). Reconnecting...",D||P),this.status==="connect"&&this.disconnect(!0)):F()}):F()};U=()=>{const D=new Error("None of startup nodes is available");this.removeListener("refresh",I),this.invokeReadyDelayedCallbacks(D),k(D)},this.once("refresh",I),this.once("close",U),this.once("close",this.handleCloseEvent.bind(this)),this.refreshSlotsCache(D=>{D&&D.message===l.default.defaultMessage&&(u.default.prototype.silentEmit.call(this,"error",D),this.connectionPool.reset([]))}),this.subscriber.start()}).catch(O=>{this.setStatus("close"),this.handleCloseEvent(O),this.invokeReadyDelayedCallbacks(O),k(O)})})}disconnect(y=!1){const k=this.status;this.setStatus("disconnecting"),y||(this.manuallyClosing=!0),this.reconnectTimeout&&!y&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null,M("Canceled reconnecting attempts")),this.clearNodesRefreshInterval(),this.subscriber.stop(),k==="wait"?(this.setStatus("close"),this.handleCloseEvent()):this.connectionPool.reset([])}quit(y){const k=this.status;if(this.setStatus("disconnecting"),this.manuallyClosing=!0,this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.clearNodesRefreshInterval(),this.subscriber.stop(),k==="wait"){const C=(0,i.default)(Promise.resolve("OK"),y);return setImmediate(function(){this.setStatus("close"),this.handleCloseEvent()}.bind(this)),C}return(0,i.default)(Promise.all(this.nodes().map(C=>C.quit().catch(O=>{if(O.message===m.CONNECTION_CLOSED_ERROR_MSG)return"OK";throw O}))).then(()=>"OK"),y)}duplicate(y=[],k={}){const C=y.length>0?y:this.startupNodes.slice(0),O=Object.assign({},this.options,k);return new b(C,O)}nodes(y="all"){if(y!=="all"&&y!=="master"&&y!=="slave")throw new Error('Invalid role "'+y+'". Expected "all", "master" or "slave"');return this.connectionPool.getNodes(y)}delayUntilReady(y){this._readyDelayedCallbacks.push(y)}get autoPipelineQueueSize(){let y=0;for(const k of this._autoPipelines.values())y+=k.length;return y}refreshSlotsCache(y){if(this.isRefreshing){y&&process.nextTick(y);return}this.isRefreshing=!0;const k=this,C=I=>{this.isRefreshing=!1,y&&y(I)},O=(0,m.shuffle)(this.connectionPool.getNodes());let F=null;function U(I){if(I===O.length){const z=new l.default(l.default.defaultMessage,F);return C(z)}const D=O[I],P=`${D.options.host}:${D.options.port}`;M("getting slot cache from %s",P),k.getInfoFromNode(D,function(z){switch(k.status){case"close":case"end":return C(new Error("Cluster is disconnected."));case"disconnecting":return C(new Error("Cluster is disconnecting."))}z?(k.emit("node error",z,P),F=z,U(I+1)):(k.emit("refresh"),C())})}U(0)}sendCommand(y,k,C){if(this.status==="wait"&&this.connect().catch(m.noop),this.status==="end")return y.reject(new Error(m.CONNECTION_CLOSED_ERROR_MSG)),y.promise;let O=this.options.scaleReads;O!=="master"&&(y.isReadOnly||(0,e.exists)(y.name)&&(0,e.hasFlag)(y.name,"readonly")||(O="master"));let F=C?C.slot:y.getSlot();const U={},I=this;if(!C&&!d.has(y)){d.add(y);const P=y.reject;y.reject=function(z){const Q=D.bind(null,!0);I.handleError(z,U,{moved:function(G,j){M("command %s is moved to %s",y.name,j),F=Number(G),I.slots[G]?I.slots[G][0]=j:I.slots[G]=[j],I._groupsBySlot[G]=I._groupsIds[I.slots[G].join(";")],I.connectionPool.findOrCreate(I.natMapper(j)),D(),M("refreshing slot caches... (triggered by MOVED error)"),I.refreshSlotsCache()},ask:function(G,j){M("command %s is required to ask %s:%s",y.name,j);const $=I.natMapper(j);I.connectionPool.findOrCreate($),D(!1,`${$.host}:${$.port}`)},tryagain:Q,clusterDown:Q,connectionClosed:Q,maxRedirections:function(G){P.call(y,G)},defaults:function(){P.call(y,z)}})}}D();function D(P,z){if(I.status==="end"){y.reject(new r.AbortError("Cluster is ended."));return}let Q;if(I.status==="ready"||y.name==="cluster"){if(C&&C.redis)Q=C.redis;else if(o.default.checkFlag("ENTER_SUBSCRIBER_MODE",y.name)||o.default.checkFlag("EXIT_SUBSCRIBER_MODE",y.name)){if(Q=I.subscriber.getInstance(),!Q){y.reject(new r.AbortError("No subscriber for the cluster"));return}}else{if(!P){if(typeof F=="number"&&I.slots[F]){const G=I.slots[F];if(typeof O=="function"){const j=G.map(function($){return I.connectionPool.getInstanceByKey($)});Q=O(j,y),Array.isArray(Q)&&(Q=(0,m.sample)(Q)),Q||(Q=j[0])}else{let j;O==="all"?j=(0,m.sample)(G):O==="slave"&&G.length>1?j=(0,m.sample)(G,1):j=G[0],Q=I.connectionPool.getInstanceByKey(j)}}z&&(Q=I.connectionPool.getInstanceByKey(z),Q.asking())}Q||(Q=(typeof O=="function"?null:I.connectionPool.getSampleInstance(O))||I.connectionPool.getSampleInstance("all"))}C&&!C.redis&&(C.redis=Q)}Q?Q.sendCommand(y,k):I.options.enableOfflineQueue?I.offlineQueue.push({command:y,stream:k,node:C}):y.reject(new Error("Cluster isn't ready and enableOfflineQueue options is false"))}return y.promise}sscanStream(y,k){return this.createScanStream("sscan",{key:y,options:k})}sscanBufferStream(y,k){return this.createScanStream("sscanBuffer",{key:y,options:k})}hscanStream(y,k){return this.createScanStream("hscan",{key:y,options:k})}hscanBufferStream(y,k){return this.createScanStream("hscanBuffer",{key:y,options:k})}zscanStream(y,k){return this.createScanStream("zscan",{key:y,options:k})}zscanBufferStream(y,k){return this.createScanStream("zscanBuffer",{key:y,options:k})}handleError(y,k,C){if(typeof k.value>"u"?k.value=this.options.maxRedirections:k.value-=1,k.value<=0){C.maxRedirections(new Error("Too many Cluster redirections. Last error: "+y));return}const O=y.message.split(" ");if(O[0]==="MOVED"){const F=this.options.retryDelayOnMoved;F&&typeof F=="number"?this.delayQueue.push("moved",C.moved.bind(null,O[1],O[2]),{timeout:F}):C.moved(O[1],O[2])}else O[0]==="ASK"?C.ask(O[1],O[2]):O[0]==="TRYAGAIN"?this.delayQueue.push("tryagain",C.tryagain,{timeout:this.options.retryDelayOnTryAgain}):O[0]==="CLUSTERDOWN"&&this.options.retryDelayOnClusterDown>0?this.delayQueue.push("clusterdown",C.connectionClosed,{timeout:this.options.retryDelayOnClusterDown,callback:this.refreshSlotsCache.bind(this)}):y.message===m.CONNECTION_CLOSED_ERROR_MSG&&this.options.retryDelayOnFailover>0&&this.status==="ready"?this.delayQueue.push("failover",C.connectionClosed,{timeout:this.options.retryDelayOnFailover,callback:this.refreshSlotsCache.bind(this)}):C.defaults()}resetOfflineQueue(){this.offlineQueue=new v}clearNodesRefreshInterval(){this.slotsTimer&&(clearTimeout(this.slotsTimer),this.slotsTimer=null)}resetNodesRefreshInterval(){if(this.slotsTimer||!this.options.slotsRefreshInterval)return;const y=()=>{this.slotsTimer=setTimeout(()=>{M('refreshing slot caches... (triggered by "slotsRefreshInterval" option)'),this.refreshSlotsCache(()=>{y()})},this.options.slotsRefreshInterval)};y()}setStatus(y){M("status: %s -> %s",this.status||"[empty]",y),this.status=y,process.nextTick(()=>{this.emit(y)})}handleCloseEvent(y){y&&M("closed because %s",y);let k;!this.manuallyClosing&&typeof this.options.clusterRetryStrategy=="function"&&(k=this.options.clusterRetryStrategy.call(this,++this.retryAttempts,y)),typeof k=="number"?(this.setStatus("reconnecting"),this.reconnectTimeout=setTimeout(()=>{this.reconnectTimeout=null,M("Cluster is disconnected. Retrying after %dms",k),this.connect().catch(function(C){M("Got error %s when reconnecting. Ignoring...",C)})},k)):(this.setStatus("end"),this.flushQueue(new Error("None of startup nodes is available")))}flushQueue(y){let k;for(;k=this.offlineQueue.shift();)k.command.reject(y)}executeOfflineCommands(){if(this.offlineQueue.length){M("send %d commands in offline queue",this.offlineQueue.length);const y=this.offlineQueue;this.resetOfflineQueue();let k;for(;k=y.shift();)this.sendCommand(k.command,k.stream,k.node)}}natMapper(y){if(this.options.natMap&&typeof this.options.natMap=="object"){const k=typeof y=="string"?y:`${y.host}:${y.port}`,C=this.options.natMap[k];if(C)return M("NAT mapping %s -> %O",k,C),Object.assign({},C)}return typeof y=="string"?(0,x.nodeKeyToRedisOptions)(y):y}getInfoFromNode(y,k){if(!y)return k(new Error("Node is disconnected"));const C=y.duplicate({enableOfflineQueue:!0,enableReadyCheck:!1,retryStrategy:null,connectionName:(0,x.getConnectionName)("refresher",this.options.redisOptions&&this.options.redisOptions.connectionName)});C.on("error",m.noop),C.cluster("SLOTS",(0,m.timeout)((O,F)=>{if(C.disconnect(),O)return k(O);if(this.status==="disconnecting"||this.status==="close"||this.status==="end"){M("ignore CLUSTER.SLOTS results (count: %d) since cluster status is %s",F.length,this.status),k();return}const U=[];M("cluster slots result count: %d",F.length);for(let D=0;D<F.length;++D){const P=F[D],z=P[0],Q=P[1],G=[];for(let j=2;j<P.length;j++){if(!P[j][0])continue;const $=this.natMapper({host:P[j][0],port:P[j][1]});$.readOnly=j!==2,U.push($),G.push($.host+":"+$.port)}M("cluster slots result [%d]: slots %d~%d served by %s",D,z,Q,G);for(let j=z;j<=Q;j++)this.slots[j]=G}this._groupsIds=Object.create(null);let I=0;for(let D=0;D<16384;D++){const P=(this.slots[D]||[]).join(";");if(!P.length){this._groupsBySlot[D]=void 0;continue}this._groupsIds[P]||(this._groupsIds[P]=++I),this._groupsBySlot[D]=this._groupsIds[P]}this.connectionPool.reset(U),k()},this.options.slotsRefreshTimeout))}invokeReadyDelayedCallbacks(y){for(const k of this._readyDelayedCallbacks)process.nextTick(k,y);this._readyDelayedCallbacks=[]}readyCheck(y){this.cluster("INFO",(k,C)=>{if(k)return y(k);if(typeof C!="string")return y();let O;const F=C.split(`\r
`);for(let U=0;U<F.length;++U){const I=F[U].split(":");if(I[0]==="cluster_state"){O=I[1];break}}O==="fail"?(M("cluster state not ok (%s)",O),y(null,O)):y()})}resolveSrv(y){return new Promise((k,C)=>{this.options.resolveSrv(y,(O,F)=>{if(O)return C(O);const U=this,I=(0,x.groupSrvRecords)(F),D=Object.keys(I).sort((z,Q)=>parseInt(z)-parseInt(Q));function P(z){if(!D.length)return C(z);const Q=D[0],G=I[Q],j=(0,x.weightSrvRecords)(G);G.records.length||D.shift(),U.dnsLookup(j.name).then($=>k({host:$,port:j.port}),P)}P()})})}dnsLookup(y){return new Promise((k,C)=>{this.options.dnsLookup(y,(O,F)=>{O?(M("failed to resolve hostname %s to IP: %s",y,O.message),C(O)):(M("resolved hostname %s to IP %s",y,F),k(F))})})}async resolveStartupNodeHostnames(){if(!Array.isArray(this.startupNodes)||this.startupNodes.length===0)throw new Error("`startupNodes` should contain at least one node.");const y=(0,x.normalizeNodeOptions)(this.startupNodes),k=(0,x.getUniqueHostnamesFromOptions)(y);if(k.length===0)return y;const C=await Promise.all(k.map((this.options.useSRVRecords?this.resolveSrv:this.dnsLookup).bind(this))),O=(0,m.zipMap)(k,C);return y.map(F=>{const U=O.get(F.host);return U?this.options.useSRVRecords?Object.assign({},F,U):Object.assign({},F,{host:U}):F})}createScanStream(y,{key:k,options:C={}}){return new a.default({objectMode:!0,key:k,redis:this,command:y,...C})}}return(0,g.default)(b,t.EventEmitter),(0,h.addTransactionSupport)(b.prototype),Ft.default=b,Ft}var ht={},Ee={},Bt={};Object.defineProperty(Bt,"__esModule",{value:!0});const el=X,rl=(0,el.Debug)("AbstractConnector");class nl{constructor(t){this.connecting=!1,this.disconnectTimeout=t}check(t){return!0}disconnect(){if(this.connecting=!1,this.stream){const t=this.stream,r=setTimeout(()=>{rl("stream %s:%s still open, destroying it",t.remoteAddress,t.remotePort),t.destroy()},this.disconnectTimeout);t.on("close",()=>clearTimeout(r)),t.end()}}}Bt.default=nl;Object.defineProperty(Ee,"__esModule",{value:!0});const sl=J,il=J,ol=X,al=Bt;class cl extends al.default{constructor(t){super(t.disconnectTimeout),this.options=t}connect(t){const{options:r}=this;this.connecting=!0;let i;return"path"in r&&r.path?i={path:r.path}:(i={},"port"in r&&r.port!=null&&(i.port=r.port),"host"in r&&r.host!=null&&(i.host=r.host),"family"in r&&r.family!=null&&(i.family=r.family)),r.tls&&Object.assign(i,r.tls),new Promise((o,l)=>{process.nextTick(()=>{if(!this.connecting){l(new Error(ol.CONNECTION_CLOSED_ERROR_MSG));return}try{r.tls?this.stream=(0,il.connect)(i):this.stream=(0,sl.createConnection)(i)}catch(u){l(u);return}this.stream.once("error",u=>{this.firstError=u}),o(this.stream)})})}}Ee.default=cl;var mt={},Ce={};Object.defineProperty(Ce,"__esModule",{value:!0});function ll(e,t){return(e.host||"127.0.0.1")===(t.host||"127.0.0.1")&&(e.port||26379)===(t.port||26379)}class ul{constructor(t){this.cursor=0,this.sentinels=t.slice(0)}next(){const t=this.cursor>=this.sentinels.length;return{done:t,value:t?void 0:this.sentinels[this.cursor++]}}reset(t){t&&this.sentinels.length>1&&this.cursor!==1&&this.sentinels.unshift(...this.sentinels.splice(this.cursor-1)),this.cursor=0}add(t){for(let r=0;r<this.sentinels.length;r++)if(ll(t,this.sentinels[r]))return!1;return this.sentinels.push(t),!0}toString(){return`${JSON.stringify(this.sentinels)} @${this.cursor}`}}Ce.default=ul;var zt={};Object.defineProperty(zt,"__esModule",{value:!0});zt.FailoverDetector=void 0;const fl=X,$t=(0,fl.Debug)("FailoverDetector"),ir="+switch-master";class hl{constructor(t,r){this.isDisconnected=!1,this.connector=t,this.sentinels=r}cleanup(){this.isDisconnected=!0;for(const t of this.sentinels)t.client.disconnect()}async subscribe(){$t("Starting FailoverDetector");const t=[];for(const r of this.sentinels){const i=r.client.subscribe(ir).catch(o=>{$t("Failed to subscribe to failover messages on sentinel %s:%s (%s)",r.address.host||"127.0.0.1",r.address.port||26739,o.message)});t.push(i),r.client.on("message",o=>{!this.isDisconnected&&o===ir&&this.disconnect()})}await Promise.all(t)}disconnect(){this.isDisconnected=!0,$t("Failover detected, disconnecting"),this.connector.disconnect()}}zt.FailoverDetector=hl;var or;function _e(){if(or)return mt;or=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.SentinelIterator=void 0;const e=J,t=X,r=J,i=Ce;mt.SentinelIterator=i.default;const o=Bt,l=dt(),u=zt,a=(0,t.Debug)("SentinelConnector");let h=class extends o.default{constructor(A){if(super(A.disconnectTimeout),this.options=A,this.emitter=null,this.failoverDetector=null,!this.options.sentinels.length)throw new Error("Requires at least one sentinel to connect to.");if(!this.options.name)throw new Error("Requires the name of master.");this.sentinelIterator=new i.default(this.options.sentinels)}check(A){const p=!A.role||this.options.role===A.role;return p||(a("role invalid, expected %s, but got %s",this.options.role,A.role),this.sentinelIterator.next(),this.sentinelIterator.next(),this.sentinelIterator.reset(!0)),p}disconnect(){super.disconnect(),this.failoverDetector&&this.failoverDetector.cleanup()}connect(A){this.connecting=!0,this.retryAttempts=0;let p;const R=async()=>{const x=this.sentinelIterator.next();if(x.done){this.sentinelIterator.reset(!1);const b=typeof this.options.sentinelRetryStrategy=="function"?this.options.sentinelRetryStrategy(++this.retryAttempts):null;let B=typeof b!="number"?"All sentinels are unreachable and retry is disabled.":`All sentinels are unreachable. Retrying from scratch after ${b}ms.`;p&&(B+=` Last error: ${p.message}`),a(B);const y=new Error(B);if(typeof b=="number")return A("error",y),await new Promise(k=>setTimeout(k,b)),R();throw y}let v=null,M=null;try{v=await this.resolve(x.value)}catch(b){M=b}if(!this.connecting)throw new Error(t.CONNECTION_CLOSED_ERROR_MSG);const d=x.value.host+":"+x.value.port;if(v)return a("resolved: %s:%s from sentinel %s",v.host,v.port,d),this.options.enableTLSForSentinelMode&&this.options.tls?(Object.assign(v,this.options.tls),this.stream=(0,r.connect)(v),this.stream.once("secureConnect",this.initFailoverDetector.bind(this))):(this.stream=(0,e.createConnection)(v),this.stream.once("connect",this.initFailoverDetector.bind(this))),this.stream.once("error",b=>{this.firstError=b}),this.stream;{const b=M?"failed to connect to sentinel "+d+" because "+M.message:"connected to sentinel "+d+" successfully, but got an invalid reply: "+v;return a(b),A("sentinelError",new Error(b)),M&&(p=M),R()}};return R()}async updateSentinels(A){if(!this.options.updateSentinels)return;const p=await A.sentinel("sentinels",this.options.name);Array.isArray(p)&&(p.map(t.packObject).forEach(R=>{if((R.flags?R.flags.split(","):[]).indexOf("disconnected")===-1&&R.ip&&R.port){const v=this.sentinelNatResolve(g(R));this.sentinelIterator.add(v)&&a("adding sentinel %s:%s",v.host,v.port)}}),a("Updated internal sentinels: %s",this.sentinelIterator))}async resolveMaster(A){const p=await A.sentinel("get-master-addr-by-name",this.options.name);return await this.updateSentinels(A),this.sentinelNatResolve(Array.isArray(p)?{host:p[0],port:Number(p[1])}:null)}async resolveSlave(A){const p=await A.sentinel("slaves",this.options.name);if(!Array.isArray(p))return null;const R=p.map(t.packObject).filter(x=>x.flags&&!x.flags.match(/(disconnected|s_down|o_down)/));return this.sentinelNatResolve(m(R,this.options.preferredSlaves))}sentinelNatResolve(A){return!A||!this.options.natMap?A:this.options.natMap[`${A.host}:${A.port}`]||A}connectToSentinel(A,p){return new l.default({port:A.port||26379,host:A.host,username:this.options.sentinelUsername||null,password:this.options.sentinelPassword||null,family:A.family||("path"in this.options&&this.options.path?void 0:this.options.family),tls:this.options.sentinelTLS,retryStrategy:null,enableReadyCheck:!1,connectTimeout:this.options.connectTimeout,commandTimeout:this.options.sentinelCommandTimeout,...p})}async resolve(A){const p=this.connectToSentinel(A);p.on("error",w);try{return this.options.role==="slave"?await this.resolveSlave(p):await this.resolveMaster(p)}finally{p.disconnect()}}async initFailoverDetector(){var A;if(!this.options.failoverDetector)return;this.sentinelIterator.reset(!0);const p=[];for(;p.length<this.options.sentinelMaxConnections;){const{done:R,value:x}=this.sentinelIterator.next();if(R)break;const v=this.connectToSentinel(x,{lazyConnect:!0,retryStrategy:this.options.sentinelReconnectStrategy});v.on("reconnecting",()=>{var M;(M=this.emitter)===null||M===void 0||M.emit("sentinelReconnecting")}),p.push({address:x,client:v})}this.sentinelIterator.reset(!1),this.failoverDetector&&this.failoverDetector.cleanup(),this.failoverDetector=new u.FailoverDetector(this,p),await this.failoverDetector.subscribe(),(A=this.emitter)===null||A===void 0||A.emit("failoverSubscribed")}};mt.default=h;function m(E,A){if(E.length===0)return null;let p;if(typeof A=="function")p=A(E);else if(A!==null&&typeof A=="object"){const R=Array.isArray(A)?A:[A];R.sort((x,v)=>(x.prio||(x.prio=1),v.prio||(v.prio=1),x.prio<v.prio?-1:x.prio>v.prio?1:0));for(let x=0;x<R.length;x++){for(let v=0;v<E.length;v++){const M=E[v];if(M.ip===R[x].ip&&M.port===R[x].port){p=M;break}}if(p)break}}return p||(p=(0,t.sample)(E)),g(p)}function g(E){return{host:E.ip,port:Number(E.port)}}function w(){}return mt}var ar;function pl(){if(ar)return ht;ar=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.SentinelConnector=ht.StandaloneConnector=void 0;const e=Ee;ht.StandaloneConnector=e.default;const t=_e();return ht.SentinelConnector=t.default,ht}var Br={},Gt={},Ae={};Object.defineProperty(Ae,"__esModule",{value:!0});const dl=kt;class yl extends dl.AbortError{constructor(t){const r=`Reached the max retries per request limit (which is ${t}). Refer to "maxRetriesPerRequest" option for details.`;super(r),Error.captureStackTrace(this,this.constructor)}get name(){return this.constructor.name}}Ae.default=yl;Object.defineProperty(Gt,"__esModule",{value:!0});Gt.MaxRetriesPerRequestError=void 0;const gl=Ae;Gt.MaxRetriesPerRequestError=gl.default;var Be={},Te={},qt={};qt.byteLength=Sl;qt.toByteArray=wl;qt.fromByteArray=El;var it=[],rt=[],ml=typeof Uint8Array<"u"?Uint8Array:Array,te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var bt=0,bl=te.length;bt<bl;++bt)it[bt]=te[bt],rt[te.charCodeAt(bt)]=bt;rt["-".charCodeAt(0)]=62;rt["_".charCodeAt(0)]=63;function Tr(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var i=r===t?0:4-r%4;return[r,i]}function Sl(e){var t=Tr(e),r=t[0],i=t[1];return(r+i)*3/4-i}function kl(e,t,r){return(t+r)*3/4-r}function wl(e){var t,r=Tr(e),i=r[0],o=r[1],l=new ml(kl(e,i,o)),u=0,a=o>0?i-4:i,h;for(h=0;h<a;h+=4)t=rt[e.charCodeAt(h)]<<18|rt[e.charCodeAt(h+1)]<<12|rt[e.charCodeAt(h+2)]<<6|rt[e.charCodeAt(h+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=t&255;return o===2&&(t=rt[e.charCodeAt(h)]<<2|rt[e.charCodeAt(h+1)]>>4,l[u++]=t&255),o===1&&(t=rt[e.charCodeAt(h)]<<10|rt[e.charCodeAt(h+1)]<<4|rt[e.charCodeAt(h+2)]>>2,l[u++]=t>>8&255,l[u++]=t&255),l}function vl(e){return it[e>>18&63]+it[e>>12&63]+it[e>>6&63]+it[e&63]}function xl(e,t,r){for(var i,o=[],l=t;l<r;l+=3)i=(e[l]<<16&16711680)+(e[l+1]<<8&65280)+(e[l+2]&255),o.push(vl(i));return o.join("")}function El(e){for(var t,r=e.length,i=r%3,o=[],l=16383,u=0,a=r-i;u<a;u+=l)o.push(xl(e,u,u+l>a?a:u+l));return i===1?(t=e[r-1],o.push(it[t>>2]+it[t<<4&63]+"==")):i===2&&(t=(e[r-2]<<8)+e[r-1],o.push(it[t>>10]+it[t>>4&63]+it[t<<2&63]+"=")),o.join("")}var Me={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Me.read=function(e,t,r,i,o){var l,u,a=o*8-i-1,h=(1<<a)-1,m=h>>1,g=-7,w=r?o-1:0,E=r?-1:1,A=e[t+w];for(w+=E,l=A&(1<<-g)-1,A>>=-g,g+=a;g>0;l=l*256+e[t+w],w+=E,g-=8);for(u=l&(1<<-g)-1,l>>=-g,g+=i;g>0;u=u*256+e[t+w],w+=E,g-=8);if(l===0)l=1-m;else{if(l===h)return u?NaN:(A?-1:1)*(1/0);u=u+Math.pow(2,i),l=l-m}return(A?-1:1)*u*Math.pow(2,l-i)};Me.write=function(e,t,r,i,o,l){var u,a,h,m=l*8-o-1,g=(1<<m)-1,w=g>>1,E=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,A=i?0:l-1,p=i?1:-1,R=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,u=g):(u=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-u))<1&&(u--,h*=2),u+w>=1?t+=E/h:t+=E*Math.pow(2,1-w),t*h>=2&&(u++,h/=2),u+w>=g?(a=0,u=g):u+w>=1?(a=(t*h-1)*Math.pow(2,o),u=u+w):(a=t*Math.pow(2,w-1)*Math.pow(2,o),u=0));o>=8;e[r+A]=a&255,A+=p,a/=256,o-=8);for(u=u<<o|a,m+=o;m>0;e[r+A]=u&255,A+=p,u/=256,m-=8);e[r+A-p]|=R*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){var t=qt,r=Me,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=M,e.INSPECT_MAX_BYTES=50;var o=2147483647;e.kMaxLength=o,a.TYPED_ARRAY_SUPPORT=l(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{var c=new Uint8Array(1),n={foo:function(){return 42}};return Object.setPrototypeOf(n,Uint8Array.prototype),Object.setPrototypeOf(c,n),c.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function u(c){if(c>o)throw new RangeError('The value "'+c+'" is invalid for option "size"');var n=new Uint8Array(c);return Object.setPrototypeOf(n,a.prototype),n}function a(c,n,s){if(typeof c=="number"){if(typeof n=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return w(c)}return h(c,n,s)}a.poolSize=8192;function h(c,n,s){if(typeof c=="string")return E(c,n);if(ArrayBuffer.isView(c))return p(c);if(c==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c);if(st(c,ArrayBuffer)||c&&st(c.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(st(c,SharedArrayBuffer)||c&&st(c.buffer,SharedArrayBuffer)))return R(c,n,s);if(typeof c=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var f=c.valueOf&&c.valueOf();if(f!=null&&f!==c)return a.from(f,n,s);var S=x(c);if(S)return S;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof c[Symbol.toPrimitive]=="function")return a.from(c[Symbol.toPrimitive]("string"),n,s);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof c)}a.from=function(c,n,s){return h(c,n,s)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function m(c){if(typeof c!="number")throw new TypeError('"size" argument must be of type number');if(c<0)throw new RangeError('The value "'+c+'" is invalid for option "size"')}function g(c,n,s){return m(c),c<=0?u(c):n!==void 0?typeof s=="string"?u(c).fill(n,s):u(c).fill(n):u(c)}a.alloc=function(c,n,s){return g(c,n,s)};function w(c){return m(c),u(c<0?0:v(c)|0)}a.allocUnsafe=function(c){return w(c)},a.allocUnsafeSlow=function(c){return w(c)};function E(c,n){if((typeof n!="string"||n==="")&&(n="utf8"),!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var s=d(c,n)|0,f=u(s),S=f.write(c,n);return S!==s&&(f=f.slice(0,S)),f}function A(c){for(var n=c.length<0?0:v(c.length)|0,s=u(n),f=0;f<n;f+=1)s[f]=c[f]&255;return s}function p(c){if(st(c,Uint8Array)){var n=new Uint8Array(c);return R(n.buffer,n.byteOffset,n.byteLength)}return A(c)}function R(c,n,s){if(n<0||c.byteLength<n)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<n+(s||0))throw new RangeError('"length" is outside of buffer bounds');var f;return n===void 0&&s===void 0?f=new Uint8Array(c):s===void 0?f=new Uint8Array(c,n):f=new Uint8Array(c,n,s),Object.setPrototypeOf(f,a.prototype),f}function x(c){if(a.isBuffer(c)){var n=v(c.length)|0,s=u(n);return s.length===0||c.copy(s,0,0,n),s}if(c.length!==void 0)return typeof c.length!="number"||Vt(c.length)?u(0):A(c);if(c.type==="Buffer"&&Array.isArray(c.data))return A(c.data)}function v(c){if(c>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return c|0}function M(c){return+c!=c&&(c=0),a.alloc(+c)}a.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==a.prototype},a.compare=function(n,s){if(st(n,Uint8Array)&&(n=a.from(n,n.offset,n.byteLength)),st(s,Uint8Array)&&(s=a.from(s,s.offset,s.byteLength)),!a.isBuffer(n)||!a.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===s)return 0;for(var f=n.length,S=s.length,_=0,T=Math.min(f,S);_<T;++_)if(n[_]!==s[_]){f=n[_],S=s[_];break}return f<S?-1:S<f?1:0},a.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(n,s){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return a.alloc(0);var f;if(s===void 0)for(s=0,f=0;f<n.length;++f)s+=n[f].length;var S=a.allocUnsafe(s),_=0;for(f=0;f<n.length;++f){var T=n[f];if(st(T,Uint8Array))_+T.length>S.length?a.from(T).copy(S,_):Uint8Array.prototype.set.call(S,T,_);else if(a.isBuffer(T))T.copy(S,_);else throw new TypeError('"list" argument must be an Array of Buffers');_+=T.length}return S};function d(c,n){if(a.isBuffer(c))return c.length;if(ArrayBuffer.isView(c)||st(c,ArrayBuffer))return c.byteLength;if(typeof c!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof c);var s=c.length,f=arguments.length>2&&arguments[2]===!0;if(!f&&s===0)return 0;for(var S=!1;;)switch(n){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":return Ht(c).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s*2;case"hex":return s>>>1;case"base64":return Ne(c).length;default:if(S)return f?-1:Ht(c).length;n=(""+n).toLowerCase(),S=!0}}a.byteLength=d;function b(c,n,s){var f=!1;if((n===void 0||n<0)&&(n=0),n>this.length||((s===void 0||s>this.length)&&(s=this.length),s<=0)||(s>>>=0,n>>>=0,s<=n))return"";for(c||(c="utf8");;)switch(c){case"hex":return $(this,n,s);case"utf8":case"utf-8":return P(this,n,s);case"ascii":return G(this,n,s);case"latin1":case"binary":return j(this,n,s);case"base64":return D(this,n,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pr(this,n,s);default:if(f)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),f=!0}}a.prototype._isBuffer=!0;function B(c,n,s){var f=c[n];c[n]=c[s],c[s]=f}a.prototype.swap16=function(){var n=this.length;if(n%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var s=0;s<n;s+=2)B(this,s,s+1);return this},a.prototype.swap32=function(){var n=this.length;if(n%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var s=0;s<n;s+=4)B(this,s,s+3),B(this,s+1,s+2);return this},a.prototype.swap64=function(){var n=this.length;if(n%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var s=0;s<n;s+=8)B(this,s,s+7),B(this,s+1,s+6),B(this,s+2,s+5),B(this,s+3,s+4);return this},a.prototype.toString=function(){var n=this.length;return n===0?"":arguments.length===0?P(this,0,n):b.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(n){if(!a.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:a.compare(this,n)===0},a.prototype.inspect=function(){var n="",s=e.INSPECT_MAX_BYTES;return n=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(n+=" ... "),"<Buffer "+n+">"},i&&(a.prototype[i]=a.prototype.inspect),a.prototype.compare=function(n,s,f,S,_){if(st(n,Uint8Array)&&(n=a.from(n,n.offset,n.byteLength)),!a.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(s===void 0&&(s=0),f===void 0&&(f=n?n.length:0),S===void 0&&(S=0),_===void 0&&(_=this.length),s<0||f>n.length||S<0||_>this.length)throw new RangeError("out of range index");if(S>=_&&s>=f)return 0;if(S>=_)return-1;if(s>=f)return 1;if(s>>>=0,f>>>=0,S>>>=0,_>>>=0,this===n)return 0;for(var T=_-S,N=f-s,L=Math.min(T,N),q=this.slice(S,_),W=n.slice(s,f),H=0;H<L;++H)if(q[H]!==W[H]){T=q[H],N=W[H];break}return T<N?-1:N<T?1:0};function y(c,n,s,f,S){if(c.length===0)return-1;if(typeof s=="string"?(f=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),s=+s,Vt(s)&&(s=S?0:c.length-1),s<0&&(s=c.length+s),s>=c.length){if(S)return-1;s=c.length-1}else if(s<0)if(S)s=0;else return-1;if(typeof n=="string"&&(n=a.from(n,f)),a.isBuffer(n))return n.length===0?-1:k(c,n,s,f,S);if(typeof n=="number")return n=n&255,typeof Uint8Array.prototype.indexOf=="function"?S?Uint8Array.prototype.indexOf.call(c,n,s):Uint8Array.prototype.lastIndexOf.call(c,n,s):k(c,[n],s,f,S);throw new TypeError("val must be string, number or Buffer")}function k(c,n,s,f,S){var _=1,T=c.length,N=n.length;if(f!==void 0&&(f=String(f).toLowerCase(),f==="ucs2"||f==="ucs-2"||f==="utf16le"||f==="utf-16le")){if(c.length<2||n.length<2)return-1;_=2,T/=2,N/=2,s/=2}function L(je,Ue){return _===1?je[Ue]:je.readUInt16BE(Ue*_)}var q;if(S){var W=-1;for(q=s;q<T;q++)if(L(c,q)===L(n,W===-1?0:q-W)){if(W===-1&&(W=q),q-W+1===N)return W*_}else W!==-1&&(q-=q-W),W=-1}else for(s+N>T&&(s=T-N),q=s;q>=0;q--){for(var H=!0,Rt=0;Rt<N;Rt++)if(L(c,q+Rt)!==L(n,Rt)){H=!1;break}if(H)return q}return-1}a.prototype.includes=function(n,s,f){return this.indexOf(n,s,f)!==-1},a.prototype.indexOf=function(n,s,f){return y(this,n,s,f,!0)},a.prototype.lastIndexOf=function(n,s,f){return y(this,n,s,f,!1)};function C(c,n,s,f){s=Number(s)||0;var S=c.length-s;f?(f=Number(f),f>S&&(f=S)):f=S;var _=n.length;f>_/2&&(f=_/2);for(var T=0;T<f;++T){var N=parseInt(n.substr(T*2,2),16);if(Vt(N))return T;c[s+T]=N}return T}function O(c,n,s,f){return Mt(Ht(n,c.length-s),c,s,f)}function F(c,n,s,f){return Mt(Ur(n),c,s,f)}function U(c,n,s,f){return Mt(Ne(n),c,s,f)}function I(c,n,s,f){return Mt(Qr(n,c.length-s),c,s,f)}a.prototype.write=function(n,s,f,S){if(s===void 0)S="utf8",f=this.length,s=0;else if(f===void 0&&typeof s=="string")S=s,f=this.length,s=0;else if(isFinite(s))s=s>>>0,isFinite(f)?(f=f>>>0,S===void 0&&(S="utf8")):(S=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var _=this.length-s;if((f===void 0||f>_)&&(f=_),n.length>0&&(f<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");S||(S="utf8");for(var T=!1;;)switch(S){case"hex":return C(this,n,s,f);case"utf8":case"utf-8":return O(this,n,s,f);case"ascii":case"latin1":case"binary":return F(this,n,s,f);case"base64":return U(this,n,s,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,n,s,f);default:if(T)throw new TypeError("Unknown encoding: "+S);S=(""+S).toLowerCase(),T=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function D(c,n,s){return n===0&&s===c.length?t.fromByteArray(c):t.fromByteArray(c.slice(n,s))}function P(c,n,s){s=Math.min(c.length,s);for(var f=[],S=n;S<s;){var _=c[S],T=null,N=_>239?4:_>223?3:_>191?2:1;if(S+N<=s){var L,q,W,H;switch(N){case 1:_<128&&(T=_);break;case 2:L=c[S+1],(L&192)===128&&(H=(_&31)<<6|L&63,H>127&&(T=H));break;case 3:L=c[S+1],q=c[S+2],(L&192)===128&&(q&192)===128&&(H=(_&15)<<12|(L&63)<<6|q&63,H>2047&&(H<55296||H>57343)&&(T=H));break;case 4:L=c[S+1],q=c[S+2],W=c[S+3],(L&192)===128&&(q&192)===128&&(W&192)===128&&(H=(_&15)<<18|(L&63)<<12|(q&63)<<6|W&63,H>65535&&H<1114112&&(T=H))}}T===null?(T=65533,N=1):T>65535&&(T-=65536,f.push(T>>>10&1023|55296),T=56320|T&1023),f.push(T),S+=N}return Q(f)}var z=4096;function Q(c){var n=c.length;if(n<=z)return String.fromCharCode.apply(String,c);for(var s="",f=0;f<n;)s+=String.fromCharCode.apply(String,c.slice(f,f+=z));return s}function G(c,n,s){var f="";s=Math.min(c.length,s);for(var S=n;S<s;++S)f+=String.fromCharCode(c[S]&127);return f}function j(c,n,s){var f="";s=Math.min(c.length,s);for(var S=n;S<s;++S)f+=String.fromCharCode(c[S]);return f}function $(c,n,s){var f=c.length;(!n||n<0)&&(n=0),(!s||s<0||s>f)&&(s=f);for(var S="",_=n;_<s;++_)S+=Lr[c[_]];return S}function Pr(c,n,s){for(var f=c.slice(n,s),S="",_=0;_<f.length-1;_+=2)S+=String.fromCharCode(f[_]+f[_+1]*256);return S}a.prototype.slice=function(n,s){var f=this.length;n=~~n,s=s===void 0?f:~~s,n<0?(n+=f,n<0&&(n=0)):n>f&&(n=f),s<0?(s+=f,s<0&&(s=0)):s>f&&(s=f),s<n&&(s=n);var S=this.subarray(n,s);return Object.setPrototypeOf(S,a.prototype),S};function V(c,n,s){if(c%1!==0||c<0)throw new RangeError("offset is not uint");if(c+n>s)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(n,s,f){n=n>>>0,s=s>>>0,f||V(n,s,this.length);for(var S=this[n],_=1,T=0;++T<s&&(_*=256);)S+=this[n+T]*_;return S},a.prototype.readUintBE=a.prototype.readUIntBE=function(n,s,f){n=n>>>0,s=s>>>0,f||V(n,s,this.length);for(var S=this[n+--s],_=1;s>0&&(_*=256);)S+=this[n+--s]*_;return S},a.prototype.readUint8=a.prototype.readUInt8=function(n,s){return n=n>>>0,s||V(n,1,this.length),this[n]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(n,s){return n=n>>>0,s||V(n,2,this.length),this[n]|this[n+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(n,s){return n=n>>>0,s||V(n,2,this.length),this[n]<<8|this[n+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(n,s){return n=n>>>0,s||V(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(n,s){return n=n>>>0,s||V(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])},a.prototype.readIntLE=function(n,s,f){n=n>>>0,s=s>>>0,f||V(n,s,this.length);for(var S=this[n],_=1,T=0;++T<s&&(_*=256);)S+=this[n+T]*_;return _*=128,S>=_&&(S-=Math.pow(2,8*s)),S},a.prototype.readIntBE=function(n,s,f){n=n>>>0,s=s>>>0,f||V(n,s,this.length);for(var S=s,_=1,T=this[n+--S];S>0&&(_*=256);)T+=this[n+--S]*_;return _*=128,T>=_&&(T-=Math.pow(2,8*s)),T},a.prototype.readInt8=function(n,s){return n=n>>>0,s||V(n,1,this.length),this[n]&128?(255-this[n]+1)*-1:this[n]},a.prototype.readInt16LE=function(n,s){n=n>>>0,s||V(n,2,this.length);var f=this[n]|this[n+1]<<8;return f&32768?f|4294901760:f},a.prototype.readInt16BE=function(n,s){n=n>>>0,s||V(n,2,this.length);var f=this[n+1]|this[n]<<8;return f&32768?f|4294901760:f},a.prototype.readInt32LE=function(n,s){return n=n>>>0,s||V(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},a.prototype.readInt32BE=function(n,s){return n=n>>>0,s||V(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},a.prototype.readFloatLE=function(n,s){return n=n>>>0,s||V(n,4,this.length),r.read(this,n,!0,23,4)},a.prototype.readFloatBE=function(n,s){return n=n>>>0,s||V(n,4,this.length),r.read(this,n,!1,23,4)},a.prototype.readDoubleLE=function(n,s){return n=n>>>0,s||V(n,8,this.length),r.read(this,n,!0,52,8)},a.prototype.readDoubleBE=function(n,s){return n=n>>>0,s||V(n,8,this.length),r.read(this,n,!1,52,8)};function tt(c,n,s,f,S,_){if(!a.isBuffer(c))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>S||n<_)throw new RangeError('"value" argument is out of bounds');if(s+f>c.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(n,s,f,S){if(n=+n,s=s>>>0,f=f>>>0,!S){var _=Math.pow(2,8*f)-1;tt(this,n,s,f,_,0)}var T=1,N=0;for(this[s]=n&255;++N<f&&(T*=256);)this[s+N]=n/T&255;return s+f},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(n,s,f,S){if(n=+n,s=s>>>0,f=f>>>0,!S){var _=Math.pow(2,8*f)-1;tt(this,n,s,f,_,0)}var T=f-1,N=1;for(this[s+T]=n&255;--T>=0&&(N*=256);)this[s+T]=n/N&255;return s+f},a.prototype.writeUint8=a.prototype.writeUInt8=function(n,s,f){return n=+n,s=s>>>0,f||tt(this,n,s,1,255,0),this[s]=n&255,s+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(n,s,f){return n=+n,s=s>>>0,f||tt(this,n,s,2,65535,0),this[s]=n&255,this[s+1]=n>>>8,s+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(n,s,f){return n=+n,s=s>>>0,f||tt(this,n,s,2,65535,0),this[s]=n>>>8,this[s+1]=n&255,s+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(n,s,f){return n=+n,s=s>>>0,f||tt(this,n,s,4,4294967295,0),this[s+3]=n>>>24,this[s+2]=n>>>16,this[s+1]=n>>>8,this[s]=n&255,s+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(n,s,f){return n=+n,s=s>>>0,f||tt(this,n,s,4,4294967295,0),this[s]=n>>>24,this[s+1]=n>>>16,this[s+2]=n>>>8,this[s+3]=n&255,s+4},a.prototype.writeIntLE=function(n,s,f,S){if(n=+n,s=s>>>0,!S){var _=Math.pow(2,8*f-1);tt(this,n,s,f,_-1,-_)}var T=0,N=1,L=0;for(this[s]=n&255;++T<f&&(N*=256);)n<0&&L===0&&this[s+T-1]!==0&&(L=1),this[s+T]=(n/N>>0)-L&255;return s+f},a.prototype.writeIntBE=function(n,s,f,S){if(n=+n,s=s>>>0,!S){var _=Math.pow(2,8*f-1);tt(this,n,s,f,_-1,-_)}var T=f-1,N=1,L=0;for(this[s+T]=n&255;--T>=0&&(N*=256);)n<0&&L===0&&this[s+T+1]!==0&&(L=1),this[s+T]=(n/N>>0)-L&255;return s+f},a.prototype.writeInt8=function(n,s,f){return n=+n,s=s>>>0,f||tt(this,n,s,1,127,-128),n<0&&(n=255+n+1),this[s]=n&255,s+1},a.prototype.writeInt16LE=function(n,s,f){return n=+n,s=s>>>0,f||tt(this,n,s,2,32767,-32768),this[s]=n&255,this[s+1]=n>>>8,s+2},a.prototype.writeInt16BE=function(n,s,f){return n=+n,s=s>>>0,f||tt(this,n,s,2,32767,-32768),this[s]=n>>>8,this[s+1]=n&255,s+2},a.prototype.writeInt32LE=function(n,s,f){return n=+n,s=s>>>0,f||tt(this,n,s,4,2147483647,-2147483648),this[s]=n&255,this[s+1]=n>>>8,this[s+2]=n>>>16,this[s+3]=n>>>24,s+4},a.prototype.writeInt32BE=function(n,s,f){return n=+n,s=s>>>0,f||tt(this,n,s,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),this[s]=n>>>24,this[s+1]=n>>>16,this[s+2]=n>>>8,this[s+3]=n&255,s+4};function Ie(c,n,s,f,S,_){if(s+f>c.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function De(c,n,s,f,S){return n=+n,s=s>>>0,S||Ie(c,n,s,4),r.write(c,n,s,f,23,4),s+4}a.prototype.writeFloatLE=function(n,s,f){return De(this,n,s,!0,f)},a.prototype.writeFloatBE=function(n,s,f){return De(this,n,s,!1,f)};function Pe(c,n,s,f,S){return n=+n,s=s>>>0,S||Ie(c,n,s,8),r.write(c,n,s,f,52,8),s+8}a.prototype.writeDoubleLE=function(n,s,f){return Pe(this,n,s,!0,f)},a.prototype.writeDoubleBE=function(n,s,f){return Pe(this,n,s,!1,f)},a.prototype.copy=function(n,s,f,S){if(!a.isBuffer(n))throw new TypeError("argument should be a Buffer");if(f||(f=0),!S&&S!==0&&(S=this.length),s>=n.length&&(s=n.length),s||(s=0),S>0&&S<f&&(S=f),S===f||n.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(S<0)throw new RangeError("sourceEnd out of bounds");S>this.length&&(S=this.length),n.length-s<S-f&&(S=n.length-s+f);var _=S-f;return this===n&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(s,f,S):Uint8Array.prototype.set.call(n,this.subarray(f,S),s),_},a.prototype.fill=function(n,s,f,S){if(typeof n=="string"){if(typeof s=="string"?(S=s,s=0,f=this.length):typeof f=="string"&&(S=f,f=this.length),S!==void 0&&typeof S!="string")throw new TypeError("encoding must be a string");if(typeof S=="string"&&!a.isEncoding(S))throw new TypeError("Unknown encoding: "+S);if(n.length===1){var _=n.charCodeAt(0);(S==="utf8"&&_<128||S==="latin1")&&(n=_)}}else typeof n=="number"?n=n&255:typeof n=="boolean"&&(n=Number(n));if(s<0||this.length<s||this.length<f)throw new RangeError("Out of range index");if(f<=s)return this;s=s>>>0,f=f===void 0?this.length:f>>>0,n||(n=0);var T;if(typeof n=="number")for(T=s;T<f;++T)this[T]=n;else{var N=a.isBuffer(n)?n:a.from(n,S),L=N.length;if(L===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(T=0;T<f-s;++T)this[T+s]=N[T%L]}return this};var Nr=/[^+/0-9A-Za-z-_]/g;function jr(c){if(c=c.split("=")[0],c=c.trim().replace(Nr,""),c.length<2)return"";for(;c.length%4!==0;)c=c+"=";return c}function Ht(c,n){n=n||1/0;for(var s,f=c.length,S=null,_=[],T=0;T<f;++T){if(s=c.charCodeAt(T),s>55295&&s<57344){if(!S){if(s>56319){(n-=3)>-1&&_.push(239,191,189);continue}else if(T+1===f){(n-=3)>-1&&_.push(239,191,189);continue}S=s;continue}if(s<56320){(n-=3)>-1&&_.push(239,191,189),S=s;continue}s=(S-55296<<10|s-56320)+65536}else S&&(n-=3)>-1&&_.push(239,191,189);if(S=null,s<128){if((n-=1)<0)break;_.push(s)}else if(s<2048){if((n-=2)<0)break;_.push(s>>6|192,s&63|128)}else if(s<65536){if((n-=3)<0)break;_.push(s>>12|224,s>>6&63|128,s&63|128)}else if(s<1114112){if((n-=4)<0)break;_.push(s>>18|240,s>>12&63|128,s>>6&63|128,s&63|128)}else throw new Error("Invalid code point")}return _}function Ur(c){for(var n=[],s=0;s<c.length;++s)n.push(c.charCodeAt(s)&255);return n}function Qr(c,n){for(var s,f,S,_=[],T=0;T<c.length&&!((n-=2)<0);++T)s=c.charCodeAt(T),f=s>>8,S=s%256,_.push(S),_.push(f);return _}function Ne(c){return t.toByteArray(jr(c))}function Mt(c,n,s,f){for(var S=0;S<f&&!(S+s>=n.length||S>=c.length);++S)n[S+s]=c[S];return S}function st(c,n){return c instanceof n||c!=null&&c.constructor!=null&&c.constructor.name!=null&&c.constructor.name===n.name}function Vt(c){return c!==c}var Lr=function(){for(var c="0123456789abcdef",n=new Array(256),s=0;s<16;++s)for(var f=s*16,S=0;S<16;++S)n[f+S]=c[s]+c[S];return n}()})(Te);var Mr={},le={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(e,t){var r=Te,i=r.Buffer;function o(u,a){for(var h in u)a[h]=u[h]}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=l);function l(u,a,h){return i(u,a,h)}l.prototype=Object.create(i.prototype),o(i,l),l.from=function(u,a,h){if(typeof u=="number")throw new TypeError("Argument must not be a number");return i(u,a,h)},l.alloc=function(u,a,h){if(typeof u!="number")throw new TypeError("Argument must be a number");var m=i(u);return a!==void 0?typeof h=="string"?m.fill(a,h):m.fill(a):m.fill(0),m},l.allocUnsafe=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return i(u)},l.allocUnsafeSlow=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(u)}})(le,le.exports);var Cl=le.exports,Re=Cl.Buffer,cr=Re.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _l(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function Al(e){var t=_l(e);if(typeof t!="string"&&(Re.isEncoding===cr||!cr(e)))throw new Error("Unknown encoding: "+e);return t||e}Mr.StringDecoder=Tt;function Tt(e){this.encoding=Al(e);var t;switch(this.encoding){case"utf16le":this.text=Fl,this.end=Il,t=4;break;case"utf8":this.fillLast=Ml,t=4;break;case"base64":this.text=Dl,this.end=Pl,t=3;break;default:this.write=Nl,this.end=jl;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Re.allocUnsafe(t)}Tt.prototype.write=function(e){if(e.length===0)return"";var t,r;if(this.lastNeed){if(t=this.fillLast(e),t===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""};Tt.prototype.end=Ol;Tt.prototype.text=Rl;Tt.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};function ee(e){return e<=127?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:e>>6===2?-1:-2}function Bl(e,t,r){var i=t.length-1;if(i<r)return 0;var o=ee(t[i]);return o>=0?(o>0&&(e.lastNeed=o-1),o):--i<r||o===-2?0:(o=ee(t[i]),o>=0?(o>0&&(e.lastNeed=o-2),o):--i<r||o===-2?0:(o=ee(t[i]),o>=0?(o>0&&(o===2?o=0:e.lastNeed=o-3),o):0))}function Tl(e,t,r){if((t[0]&192)!==128)return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if((t[1]&192)!==128)return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&(t[2]&192)!==128)return e.lastNeed=2,"�"}}function Ml(e){var t=this.lastTotal-this.lastNeed,r=Tl(this,e);if(r!==void 0)return r;if(this.lastNeed<=e.length)return e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,t,0,e.length),this.lastNeed-=e.length}function Rl(e,t){var r=Bl(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)}function Ol(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t}function Fl(e,t){if((e.length-t)%2===0){var r=e.toString("utf16le",t);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function Il(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function Dl(e,t){var r=(e.length-t)%3;return r===0?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function Pl(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function Nl(e){return e.toString(this.encoding)}function jl(e){return e&&e.length?this.write(e):""}const Oe=Te.Buffer,Ul=Mr.StringDecoder,re=new Ul,Rr=kt,Ql=Rr.ReplyError,Ll=Rr.ParserError;var nt=Oe.allocUnsafe(32*1024),Z=0,Nt=null,vt=0,ne=0;function zl(e){const t=e.buffer.length-1;var r=e.offset,i=0,o=1;for(e.buffer[r]===45&&(o=-1,r++);r<t;){const l=e.buffer[r++];if(l===13)return e.offset=r+1,o*i;i=i*10+(l-48)}}function Gl(e){const t=e.buffer.length-1;var r=e.offset,i=0,o="";for(e.buffer[r]===45&&(o+="-",r++);r<t;){var l=e.buffer[r++];if(l===13)return e.offset=r+1,i!==0&&(o+=i),o;i>429496728?(o+=i*10+(l-48),i=0):l===48&&i===0?o+=0:i=i*10+(l-48)}}function Or(e){const t=e.offset,r=e.buffer,i=r.length-1;for(var o=t;o<i;)if(r[o++]===13)return e.offset=o+1,e.optionReturnBuffers===!0?e.buffer.slice(t,o-1):e.buffer.toString("utf8",t,o-1)}function Fr(e){const t=e.buffer.length-1;for(var r=e.offset,i=0;r<t;){const o=e.buffer[r++];if(o===13)return e.offset=r+1,i;i=i*10+(o-48)}}function ql(e){return e.optionStringNumbers===!0?Gl(e):zl(e)}function Yl(e){const t=Fr(e);if(t===void 0)return;if(t<0)return null;const r=e.offset+t;if(r+2>e.buffer.length){e.bigStrSize=r+2,e.totalChunkSize=e.buffer.length,e.bufferCache.push(e.buffer);return}const i=e.offset;return e.offset=r+2,e.optionReturnBuffers===!0?e.buffer.slice(i,r):e.buffer.toString("utf8",i,r)}function Hl(e){var t=Or(e);if(t!==void 0)return e.optionReturnBuffers===!0&&(t=t.toString()),new Ql(t)}function Vl(e,t){const r=new Ll("Protocol error, got "+JSON.stringify(String.fromCharCode(t))+" as reply type byte",JSON.stringify(e.buffer),e.offset);e.buffer=null,e.returnFatalError(r)}function Kl(e){const t=Fr(e);if(t===void 0)return;if(t<0)return null;const r=new Array(t);return Ir(e,r,0)}function ue(e,t,r){e.arrayCache.push(t),e.arrayPos.push(r)}function fe(e){const t=e.arrayCache.pop();var r=e.arrayPos.pop();if(e.arrayCache.length){const i=fe(e);if(i===void 0){ue(e,t,r);return}t[r++]=i}return Ir(e,t,r)}function Ir(e,t,r){const i=e.buffer.length;for(;r<t.length;){const o=e.offset;if(e.offset>=i){ue(e,t,r);return}const l=Dr(e,e.buffer[e.offset++]);if(l===void 0){e.arrayCache.length||e.bufferCache.length||(e.offset=o),ue(e,t,r);return}t[r]=l,r++}return t}function Dr(e,t){switch(t){case 36:return Yl(e);case 43:return Or(e);case 42:return Kl(e);case 58:return ql(e);case 45:return Hl(e);default:return Vl(e,t)}}function Wl(){if(nt.length>50*1024)if(vt===1||ne>vt*2){const e=Math.floor(nt.length/10),t=e<Z?Z:e;Z=0,nt=nt.slice(t,nt.length)}else ne++,vt--;else clearInterval(Nt),vt=0,ne=0,Nt=null}function Jl(e){if(nt.length<e+Z){const t=e>78643200?2:3;Z>1024*1024*111&&(Z=1024*1024*50),nt=Oe.allocUnsafe(e*t+Z),Z=0,vt++,Nt===null&&(Nt=setInterval(Wl,50))}}function Xl(e){const t=e.bufferCache,r=e.offset;var i=t.length,o=e.bigStrSize-e.totalChunkSize;if(e.offset=o,o<=2){if(i===2)return t[0].toString("utf8",r,t[0].length+o-2);i--,o=t[t.length-2].length+o}for(var l=re.write(t[0].slice(r)),u=1;u<i-1;u++)l+=re.write(t[u]);return l+=re.end(t[u].slice(0,o-2)),l}function Zl(e){const t=e.bufferCache,r=e.offset,i=e.bigStrSize-r-2;var o=t.length,l=e.bigStrSize-e.totalChunkSize;if(e.offset=l,l<=2){if(o===2)return t[0].slice(r,t[0].length+l-2);o--,l=t[t.length-2].length+l}Jl(i);const u=Z;t[0].copy(nt,u,r,t[0].length),Z+=t[0].length-r;for(var a=1;a<o-1;a++)t[a].copy(nt,Z),Z+=t[a].length;return t[a].copy(nt,Z,0,l-2),Z+=l-2,nt.slice(u,Z)}class $l{constructor(t){if(!t)throw new TypeError("Options are mandatory.");if(typeof t.returnError!="function"||typeof t.returnReply!="function")throw new TypeError("The returnReply and returnError options have to be functions.");this.setReturnBuffers(!!t.returnBuffers),this.setStringNumbers(!!t.stringNumbers),this.returnError=t.returnError,this.returnFatalError=t.returnFatalError||t.returnError,this.returnReply=t.returnReply,this.reset()}reset(){this.offset=0,this.buffer=null,this.bigStrSize=0,this.totalChunkSize=0,this.bufferCache=[],this.arrayCache=[],this.arrayPos=[]}setReturnBuffers(t){if(typeof t!="boolean")throw new TypeError("The returnBuffers argument has to be a boolean");this.optionReturnBuffers=t}setStringNumbers(t){if(typeof t!="boolean")throw new TypeError("The stringNumbers argument has to be a boolean");this.optionStringNumbers=t}execute(t){if(this.buffer===null)this.buffer=t,this.offset=0;else if(this.bigStrSize===0){const i=this.buffer.length,o=i-this.offset,l=Oe.allocUnsafe(o+t.length);if(this.buffer.copy(l,0,this.offset,i),t.copy(l,o,0,t.length),this.buffer=l,this.offset=0,this.arrayCache.length){const u=fe(this);if(u===void 0)return;this.returnReply(u)}}else if(this.totalChunkSize+t.length>=this.bigStrSize){this.bufferCache.push(t);var r=this.optionReturnBuffers?Zl(this):Xl(this);if(this.bigStrSize=0,this.bufferCache=[],this.buffer=t,this.arrayCache.length&&(this.arrayCache[0][this.arrayPos[0]++]=r,r=fe(this),r===void 0))return;this.returnReply(r)}else{this.bufferCache.push(t),this.totalChunkSize+=t.length;return}for(;this.offset<this.buffer.length;){const i=this.offset,o=this.buffer[this.offset++],l=Dr(this,o);if(l===void 0){this.arrayCache.length||this.bufferCache.length||(this.offset=i);return}o===45?this.returnError(l):this.returnReply(l)}this.buffer=null}}var tu=$l,eu=tu,Fe={};Object.defineProperty(Fe,"__esModule",{value:!0});class ru{constructor(){this.set={subscribe:{},psubscribe:{},ssubscribe:{}}}add(t,r){this.set[se(t)][r]=!0}del(t,r){delete this.set[se(t)][r]}channels(t){return Object.keys(this.set[se(t)])}isEmpty(){return this.channels("subscribe").length===0&&this.channels("psubscribe").length===0&&this.channels("ssubscribe").length===0}}Fe.default=ru;function se(e){return e==="unsubscribe"?"subscribe":e==="punsubscribe"?"psubscribe":e==="sunsubscribe"?"ssubscribe":e}Object.defineProperty(Be,"__esModule",{value:!0});const lr=at,nu=X,su=eu,iu=Fe,ou=(0,nu.Debug)("dataHandler");class au{constructor(t,r){this.redis=t;const i=new su({stringNumbers:r.stringNumbers,returnBuffers:!0,returnError:o=>{this.returnError(o)},returnFatalError:o=>{this.returnFatalError(o)},returnReply:o=>{this.returnReply(o)}});t.stream.on("data",o=>{i.execute(o)})}returnFatalError(t){t.message+=". Please report this.",this.redis.recoverFromFatalError(t,t,{offlineQueue:!1})}returnError(t){const r=this.shiftCommand(t);r&&(t.command={name:r.command.name,args:r.command.args},this.redis.handleReconnection(t,r))}returnReply(t){if(this.handleMonitorReply(t)||this.handleSubscriberReply(t))return;const r=this.shiftCommand(t);r&&(lr.default.checkFlag("ENTER_SUBSCRIBER_MODE",r.command.name)?(this.redis.condition.subscriber=new iu.default,this.redis.condition.subscriber.add(r.command.name,t[1].toString()),ur(r.command,t[2])||this.redis.commandQueue.unshift(r)):lr.default.checkFlag("EXIT_SUBSCRIBER_MODE",r.command.name)?fr(r.command,t[2])||this.redis.commandQueue.unshift(r):r.command.resolve(t))}handleSubscriberReply(t){if(!this.redis.condition.subscriber)return!1;const r=Array.isArray(t)?t[0].toString():null;switch(ou('receive reply "%s" in subscriber mode',r),r){case"message":this.redis.listeners("message").length>0&&this.redis.emit("message",t[1].toString(),t[2]?t[2].toString():""),this.redis.emit("messageBuffer",t[1],t[2]);break;case"pmessage":{const i=t[1].toString();this.redis.listeners("pmessage").length>0&&this.redis.emit("pmessage",i,t[2].toString(),t[3].toString()),this.redis.emit("pmessageBuffer",i,t[2],t[3]);break}case"smessage":{this.redis.listeners("smessage").length>0&&this.redis.emit("smessage",t[1].toString(),t[2]?t[2].toString():""),this.redis.emit("smessageBuffer",t[1],t[2]);break}case"ssubscribe":case"subscribe":case"psubscribe":{const i=t[1].toString();this.redis.condition.subscriber.add(r,i);const o=this.shiftCommand(t);if(!o)return;ur(o.command,t[2])||this.redis.commandQueue.unshift(o);break}case"sunsubscribe":case"unsubscribe":case"punsubscribe":{const i=t[1]?t[1].toString():null;i&&this.redis.condition.subscriber.del(r,i);const o=t[2];Number(o)===0&&(this.redis.condition.subscriber=!1);const l=this.shiftCommand(t);if(!l)return;fr(l.command,o)||this.redis.commandQueue.unshift(l);break}default:{const i=this.shiftCommand(t);if(!i)return;i.command.resolve(t)}}return!0}handleMonitorReply(t){if(this.redis.status!=="monitoring")return!1;const r=t.toString();if(r==="OK")return!1;const i=r.indexOf(" "),o=r.slice(0,i),l=r.indexOf('"'),u=r.slice(l+1,-1).split('" "').map(h=>h.replace(/\\"/g,'"')),a=r.slice(i+2,l-2).split(" ");return this.redis.emit("monitor",o,u,a[1],a[0]),!0}shiftCommand(t){const r=this.redis.commandQueue.shift();if(!r){const i="Command queue state error. If you can reproduce this, please report it.",o=new Error(i+(t instanceof Error?` Last error: ${t.message}`:` Last reply: ${t.toString()}`));return this.redis.emit("error",o),null}return r}}Be.default=au;const ft=new WeakMap;function ur(e,t){let r=ft.has(e)?ft.get(e):e.args.length;return r-=1,r<=0?(e.resolve(t),ft.delete(e),!0):(ft.set(e,r),!1)}function fr(e,t){let r=ft.has(e)?ft.get(e):e.args.length;return r===0?Number(t)===0?(ft.delete(e),e.resolve(t),!0):!1:(r-=1,r<=0?(e.resolve(t),!0):(ft.set(e,r),!1))}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.readyHandler=e.errorHandler=e.closeHandler=e.connectHandler=void 0;const t=kt,r=at,i=Gt,o=X,l=Be,u=(0,o.Debug)("connection");function a(p){return function(){p.setStatus("connect"),p.resetCommandQueue();let R=!1;const{connectionEpoch:x}=p;p.condition.auth&&p.auth(p.condition.auth,function(v){x===p.connectionEpoch&&v&&(v.message.indexOf("no password is set")!==-1?console.warn("[WARN] Redis server does not require a password, but a password was supplied."):v.message.indexOf("without any password configured for the default user")!==-1?console.warn("[WARN] This Redis server's `default` user does not require a password, but a password was supplied"):v.message.indexOf("wrong number of arguments for 'auth' command")!==-1?console.warn(`[ERROR] The server returned "wrong number of arguments for 'auth' command". You are probably passing both username and password to Redis version 5 or below. You should only pass the 'password' option for Redis version 5 and under.`):(R=!0,p.recoverFromFatalError(v,v)))}),p.condition.select&&p.select(p.condition.select).catch(v=>{p.silentEmit("error",v)}),p.options.enableReadyCheck||e.readyHandler(p)(),new l.default(p,{stringNumbers:p.options.stringNumbers}),p.options.enableReadyCheck&&p._readyCheck(function(v,M){x===p.connectionEpoch&&(v?R||p.recoverFromFatalError(new Error("Ready check failed: "+v.message),v):p.connector.check(M)?e.readyHandler(p)():p.disconnect(!0))})}}e.connectHandler=a;function h(p){const R=new t.AbortError("Command aborted due to connection close");return R.command={name:p.name,args:p.args},R}function m(p){var R;let x=0;for(let v=0;v<p.length;){const M=(R=p.peekAt(v))===null||R===void 0?void 0:R.command,d=M.pipelineIndex;if((d===void 0||d===0)&&(x=0),d!==void 0&&d!==x++){p.remove(v,1),M.reject(h(M));continue}v++}}function g(p){var R;for(let x=0;x<p.length;){const v=(R=p.peekAt(x))===null||R===void 0?void 0:R.command;if(v.name==="multi")break;if(v.name==="exec"){p.remove(x,1),v.reject(h(v));break}v.inTransaction?(p.remove(x,1),v.reject(h(v))):x++}}function w(p){return function(){const x=p.status;if(p.setStatus("close"),p.commandQueue.length&&m(p.commandQueue),p.offlineQueue.length&&g(p.offlineQueue),x==="ready"&&(p.prevCondition||(p.prevCondition=p.condition),p.commandQueue.length&&(p.prevCommandQueue=p.commandQueue)),p.manuallyClosing)return p.manuallyClosing=!1,u("skip reconnecting since the connection is manually closed."),R();if(typeof p.options.retryStrategy!="function")return u("skip reconnecting because `retryStrategy` is not a function"),R();const v=p.options.retryStrategy(++p.retryAttempts);if(typeof v!="number")return u("skip reconnecting because `retryStrategy` doesn't return a number"),R();u("reconnect in %sms",v),p.setStatus("reconnecting",v),p.reconnectTimeout=setTimeout(function(){p.reconnectTimeout=null,p.connect().catch(o.noop)},v);const{maxRetriesPerRequest:M}=p.options;typeof M=="number"&&(M<0?u("maxRetriesPerRequest is negative, ignoring..."):p.retryAttempts%(M+1)===0&&(u("reach maxRetriesPerRequest limitation, flushing command queue..."),p.flushQueue(new i.MaxRetriesPerRequestError(M))))};function R(){p.setStatus("end"),p.flushQueue(new Error(o.CONNECTION_CLOSED_ERROR_MSG))}}e.closeHandler=w;function E(p){return function(R){u("error: %s",R),p.silentEmit("error",R)}}e.errorHandler=E;function A(p){return function(){if(p.setStatus("ready"),p.retryAttempts=0,p.options.monitor){p.call("monitor").then(()=>p.setStatus("monitoring"),v=>p.emit("error",v));const{sendCommand:x}=p;p.sendCommand=function(v){return r.default.checkFlag("VALID_IN_MONITOR_MODE",v.name)?x.call(p,v):(v.reject(new Error("Connection is in monitoring mode, can't process commands.")),v.promise)},p.once("close",function(){delete p.sendCommand});return}const R=p.prevCondition?p.prevCondition.select:p.condition.select;if(p.options.connectionName&&(u("set the connection name [%s]",p.options.connectionName),p.client("setname",p.options.connectionName).catch(o.noop)),p.options.readOnly&&(u("set the connection to readonly mode"),p.readonly().catch(o.noop)),p.prevCondition){const x=p.prevCondition;if(p.prevCondition=null,x.subscriber&&p.options.autoResubscribe){p.condition.select!==R&&(u("connect to db [%d]",R),p.select(R));const v=x.subscriber.channels("subscribe");v.length&&(u("subscribe %d channels",v.length),p.subscribe(v));const M=x.subscriber.channels("psubscribe");M.length&&(u("psubscribe %d channels",M.length),p.psubscribe(M));const d=x.subscriber.channels("ssubscribe");d.length&&(u("ssubscribe %d channels",d.length),p.ssubscribe(d))}}if(p.prevCommandQueue)if(p.options.autoResendUnfulfilledCommands)for(u("resend %d unfulfilled commands",p.prevCommandQueue.length);p.prevCommandQueue.length>0;){const x=p.prevCommandQueue.shift();x.select!==p.condition.select&&x.command.name!=="select"&&p.select(x.select),p.sendCommand(x.command,x.stream)}else p.prevCommandQueue=null;if(p.offlineQueue.length){u("send %d commands in offline queue",p.offlineQueue.length);const x=p.offlineQueue;for(p.resetOfflineQueue();x.length>0;){const v=x.shift();v.select!==p.condition.select&&v.command.name!=="select"&&p.select(v.select),p.sendCommand(v.command,v.stream)}}p.condition.select!==R&&(u("connect to db [%d]",R),p.select(R))}}e.readyHandler=A})(Br);var Yt={};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.DEFAULT_REDIS_OPTIONS=void 0;Yt.DEFAULT_REDIS_OPTIONS={port:6379,host:"localhost",family:4,connectTimeout:1e4,disconnectTimeout:2e3,retryStrategy:function(e){return Math.min(e*50,2e3)},keepAlive:0,noDelay:!0,connectionName:null,sentinels:null,name:null,role:"master",sentinelRetryStrategy:function(e){return Math.min(e*10,1e3)},sentinelReconnectStrategy:function(){return 6e4},natMap:null,enableTLSForSentinelMode:!1,updateSentinels:!0,failoverDetector:!1,username:null,password:null,db:0,enableOfflineQueue:!0,enableReadyCheck:!0,autoResubscribe:!0,autoResendUnfulfilledCommands:!0,lazyConnect:!1,keyPrefix:"",reconnectOnError:null,readOnly:!1,stringNumbers:!1,maxRetriesPerRequest:20,maxLoadingRetryTime:1e4,enableAutoPipelining:!1,autoPipeliningIgnoredCommands:[],sentinelMaxConnections:10};var hr;function dt(){if(hr)return Ot;hr=1,Object.defineProperty(Ot,"__esModule",{value:!0});const e=St,t=J,r=lt,i=Ar(),o=at,l=pl(),u=_e(),a=Br,h=Yt,m=Ct,g=_t,w=X,E=Qt,A=At,p=ot,R=xe,x=(0,w.Debug)("redis");class v extends A.default{constructor(d,b,B){if(super(),this.status="wait",this.isCluster=!1,this.reconnectTimeout=null,this.connectionEpoch=0,this.retryAttempts=0,this.manuallyClosing=!1,this._autoPipelines=new Map,this._runningAutoPipelines=new Set,this.parseOptions(d,b,B),t.EventEmitter.call(this),this.resetCommandQueue(),this.resetOfflineQueue(),this.options.Connector)this.connector=new this.options.Connector(this.options);else if(this.options.sentinels){const y=new u.default(this.options);y.emitter=this,this.connector=y}else this.connector=new l.StandaloneConnector(this.options);this.options.scripts&&Object.entries(this.options.scripts).forEach(([y,k])=>{this.defineCommand(y,k)}),this.options.lazyConnect?this.setStatus("wait"):this.connect().catch(p.noop)}static createClient(...d){return new v(...d)}get autoPipelineQueueSize(){let d=0;for(const b of this._autoPipelines.values())d+=b.length;return d}connect(d){const b=new Promise((B,y)=>{if(this.status==="connecting"||this.status==="connect"||this.status==="ready"){y(new Error("Redis is already connecting/connected"));return}this.connectionEpoch+=1,this.setStatus("connecting");const{options:k}=this;this.condition={select:k.db,auth:k.username?[k.username,k.password]:k.password,subscriber:!1};const C=this;(0,r.default)(this.connector.connect(function(O,F){C.silentEmit(O,F)}),function(O,F){if(O){C.flushQueue(O),C.silentEmit("error",O),y(O),C.setStatus("end");return}let U=k.tls?"secureConnect":"connect";if("sentinels"in k&&k.sentinels&&!k.enableTLSForSentinelMode&&(U="connect"),C.stream=F,k.noDelay&&F.setNoDelay(!0),typeof k.keepAlive=="number"&&(F.connecting?F.once(U,()=>{F.setKeepAlive(!0,k.keepAlive)}):F.setKeepAlive(!0,k.keepAlive)),F.connecting){if(F.once(U,a.connectHandler(C)),k.connectTimeout){let P=!1;F.setTimeout(k.connectTimeout,function(){if(P)return;F.setTimeout(0),F.destroy();const z=new Error("connect ETIMEDOUT");z.errorno="ETIMEDOUT",z.code="ETIMEDOUT",z.syscall="connect",a.errorHandler(C)(z)}),F.once(U,function(){P=!0,F.setTimeout(0)})}}else if(F.destroyed){const P=C.connector.firstError;P&&process.nextTick(()=>{a.errorHandler(C)(P)}),process.nextTick(a.closeHandler(C))}else process.nextTick(a.connectHandler(C));F.destroyed||(F.once("error",a.errorHandler(C)),F.once("close",a.closeHandler(C)));const I=function(){C.removeListener("close",D),B()};var D=function(){C.removeListener("ready",I),y(new Error(w.CONNECTION_CLOSED_ERROR_MSG))};C.once("ready",I),C.once("close",D)})});return(0,r.default)(b,d)}disconnect(d=!1){d||(this.manuallyClosing=!0),this.reconnectTimeout&&!d&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.status==="wait"?a.closeHandler(this)():this.connector.disconnect()}end(){this.disconnect()}duplicate(d){return new v({...this.options,...d})}get mode(){var d;return this.options.monitor?"monitor":!((d=this.condition)===null||d===void 0)&&d.subscriber?"subscriber":"normal"}monitor(d){const b=this.duplicate({monitor:!0,lazyConnect:!1});return(0,r.default)(new Promise(function(B,y){b.once("error",y),b.once("monitoring",function(){B(b)})}),d)}sendCommand(d,b){var B,y;if(this.status==="wait"&&this.connect().catch(p.noop),this.status==="end")return d.reject(new Error(w.CONNECTION_CLOSED_ERROR_MSG)),d.promise;if(!((B=this.condition)===null||B===void 0)&&B.subscriber&&!o.default.checkFlag("VALID_IN_SUBSCRIBER_MODE",d.name))return d.reject(new Error("Connection in subscriber mode, only subscriber commands may be used")),d.promise;typeof this.options.commandTimeout=="number"&&d.setTimeout(this.options.commandTimeout);let k=this.status==="ready"||!b&&this.status==="connect"&&(0,e.exists)(d.name)&&(0,e.hasFlag)(d.name,"loading");if(this.stream&&this.stream.writable?this.stream._writableState&&this.stream._writableState.ended&&(k=!1):k=!1,k)x.enabled&&x("write command[%s]: %d -> %s(%o)",this._getDescription(),(y=this.condition)===null||y===void 0?void 0:y.select,d.name,d.args),b?"isPipeline"in b&&b.isPipeline?b.write(d.toWritable(b.destination.redis.stream)):b.write(d.toWritable(b)):this.stream.write(d.toWritable(this.stream)),this.commandQueue.push({command:d,stream:b,select:this.condition.select}),o.default.checkFlag("WILL_DISCONNECT",d.name)&&(this.manuallyClosing=!0);else{if(!this.options.enableOfflineQueue)return d.reject(new Error("Stream isn't writeable and enableOfflineQueue options is false")),d.promise;if(d.name==="quit"&&this.offlineQueue.length===0)return this.disconnect(),d.resolve(Buffer.from("OK")),d.promise;x.enabled&&x("queue command[%s]: %d -> %s(%o)",this._getDescription(),this.condition.select,d.name,d.args),this.offlineQueue.push({command:d,stream:b,select:this.condition.select})}if(d.name==="select"&&(0,w.isInt)(d.args[0])){const C=parseInt(d.args[0],10);this.condition.select!==C&&(this.condition.select=C,this.emit("select",C),x("switch to db [%d]",this.condition.select))}return d.promise}scanStream(d){return this.createScanStream("scan",{options:d})}scanBufferStream(d){return this.createScanStream("scanBuffer",{options:d})}sscanStream(d,b){return this.createScanStream("sscan",{key:d,options:b})}sscanBufferStream(d,b){return this.createScanStream("sscanBuffer",{key:d,options:b})}hscanStream(d,b){return this.createScanStream("hscan",{key:d,options:b})}hscanBufferStream(d,b){return this.createScanStream("hscanBuffer",{key:d,options:b})}zscanStream(d,b){return this.createScanStream("zscan",{key:d,options:b})}zscanBufferStream(d,b){return this.createScanStream("zscanBuffer",{key:d,options:b})}silentEmit(d,b){let B;if(!(d==="error"&&(B=b,this.status==="end"||this.manuallyClosing&&B instanceof Error&&(B.message===w.CONNECTION_CLOSED_ERROR_MSG||B.syscall==="connect"||B.syscall==="read"))))return this.listeners(d).length>0?this.emit.apply(this,arguments):(B&&B instanceof Error&&console.error("[ioredis] Unhandled error event:",B.stack),!1)}recoverFromFatalError(d,b,B){this.flushQueue(b,B),this.silentEmit("error",b),this.disconnect(!0)}handleReconnection(d,b){var B;let y=!1;switch(this.options.reconnectOnError&&(y=this.options.reconnectOnError(d)),y){case 1:case!0:this.status!=="reconnecting"&&this.disconnect(!0),b.command.reject(d);break;case 2:this.status!=="reconnecting"&&this.disconnect(!0),((B=this.condition)===null||B===void 0?void 0:B.select)!==b.select&&b.command.name!=="select"&&this.select(b.select),this.sendCommand(b.command);break;default:b.command.reject(d)}}_getDescription(){let d;return"path"in this.options&&this.options.path?d=this.options.path:this.stream&&this.stream.remoteAddress&&this.stream.remotePort?d=this.stream.remoteAddress+":"+this.stream.remotePort:"host"in this.options&&this.options.host?d=this.options.host+":"+this.options.port:d="",this.options.connectionName&&(d+=` (${this.options.connectionName})`),d}resetCommandQueue(){this.commandQueue=new R}resetOfflineQueue(){this.offlineQueue=new R}parseOptions(...d){const b={};let B=!1;for(let y=0;y<d.length;++y){const k=d[y];if(!(k===null||typeof k>"u"))if(typeof k=="object")(0,p.defaults)(b,k);else if(typeof k=="string")(0,p.defaults)(b,(0,w.parseURL)(k)),k.startsWith("rediss://")&&(B=!0);else if(typeof k=="number")b.port=k;else throw new Error("Invalid argument "+k)}B&&(0,p.defaults)(b,{tls:!0}),(0,p.defaults)(b,v.defaultOptions),typeof b.port=="string"&&(b.port=parseInt(b.port,10)),typeof b.db=="string"&&(b.db=parseInt(b.db,10)),this.options=(0,w.resolveTLSProfile)(b)}setStatus(d,b){x.enabled&&x("status[%s]: %s -> %s",this._getDescription(),this.status||"[empty]",d),this.status=d,process.nextTick(this.emit.bind(this,d,b))}createScanStream(d,{key:b,options:B={}}){return new m.default({objectMode:!0,key:b,redis:this,command:d,...B})}flushQueue(d,b){b=(0,p.defaults)({},b,{offlineQueue:!0,commandQueue:!0});let B;if(b.offlineQueue)for(;B=this.offlineQueue.shift();)B.command.reject(d);if(b.commandQueue&&this.commandQueue.length>0)for(this.stream&&this.stream.removeAllListeners("data");B=this.commandQueue.shift();)B.command.reject(d)}_readyCheck(d){const b=this;this.info(function(B,y){if(B)return B.message&&B.message.includes("NOPERM")?(console.warn(`Skipping the ready check because INFO command fails: "${B.message}". You can disable ready check with "enableReadyCheck". More: https://github.com/luin/ioredis/wiki/Disable-ready-check.`),d(null,{})):d(B);if(typeof y!="string")return d(null,y);const k={},C=y.split(`\r
`);for(let O=0;O<C.length;++O){const[F,...U]=C[O].split(":"),I=U.join(":");I&&(k[F]=I)}if(!k.loading||k.loading==="0")d(null,k);else{const O=(k.loading_eta_seconds||1)*1e3,F=b.options.maxLoadingRetryTime&&b.options.maxLoadingRetryTime<O?b.options.maxLoadingRetryTime:O;x("Redis server still loading, trying again in "+F+"ms"),setTimeout(function(){b._readyCheck(d)},F)}}).catch(p.noop)}}return v.Cluster=i.default,v.Command=o.default,v.defaultOptions=h.DEFAULT_REDIS_OPTIONS,(0,E.default)(v,t.EventEmitter),(0,g.addTransactionSupport)(v.prototype),Ot.default=v,Ot}(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.print=t.ReplyError=t.SentinelIterator=t.SentinelConnector=t.AbstractConnector=t.Pipeline=t.ScanStream=t.Command=t.Cluster=t.Redis=t.default=void 0,t=e.exports=dt().default;var r=dt();Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.default}});var i=dt();Object.defineProperty(t,"Redis",{enumerable:!0,get:function(){return i.default}});var o=Ar();Object.defineProperty(t,"Cluster",{enumerable:!0,get:function(){return o.default}});var l=at;Object.defineProperty(t,"Command",{enumerable:!0,get:function(){return l.default}});var u=Ct;Object.defineProperty(t,"ScanStream",{enumerable:!0,get:function(){return u.default}});var a=Ut;Object.defineProperty(t,"Pipeline",{enumerable:!0,get:function(){return a.default}});var h=Bt;Object.defineProperty(t,"AbstractConnector",{enumerable:!0,get:function(){return h.default}});var m=_e();Object.defineProperty(t,"SentinelConnector",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"SentinelIterator",{enumerable:!0,get:function(){return m.SentinelIterator}}),t.ReplyError=kt.ReplyError,Object.defineProperty(t,"Promise",{get(){return console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used."),Promise},set(w){console.warn("ioredis v5 does not support plugging third-party Promise library anymore. Native Promise will be used.")}});function g(w,E){console.log(w?"Error: "+w:"Reply: "+E)}t.print=g})(ie,ie.exports);var cu=ie.exports;const lu=Hr(cu),jt=new lu({host:"localhost",port:6379});jt.flushdb(function(e,t){console.log(t)});jt.flushall(function(e,t){console.log(t)});function uu(e){return jt.flushdb(function(t,r){console.log(r)}),jt.flushall(function(t,r){console.log(r)}),[]}class mu extends zr{constructor(t){super(),Gr(this,t,uu,null,qr,{})}}export{mu as component};
//# sourceMappingURL=12.f68b7ec8.js.map
